<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fala! â€“ Portugiesisch A1â€“A2</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Fraunces:opsz,wght@9..144,400;9..144,600;9..144,700&display=swap" rel="stylesheet">
<style>
:root{--bg:#faf8f4;--bg2:#f0ede6;--card:#fff;--text:#1a1a1a;--text2:#6b6560;--text3:#9a9490;--green:#22c55e;--green2:#16a34a;--green-bg:#dcfce7;--blue:#3b82f6;--blue2:#2563eb;--blue-bg:#dbeafe;--amber:#f59e0b;--amber-bg:#fef3c7;--red:#ef4444;--red-bg:#fee2e2;--purple:#8b5cf6;--purple-bg:#ede9fe;--teal:#0d9488;--teal-bg:#ccfbf1;--border:#e8e4de;--sh:0 1px 3px rgba(0,0,0,0.05),0 4px 12px rgba(0,0,0,0.03);--shl:0 4px 20px rgba(0,0,0,0.07);--r:16px}
*{box-sizing:border-box;margin:0;padding:0}body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;-webkit-font-smoothing:antialiased}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%,75%{transform:translateX(-5px)}50%{transform:translateX(5px)}}
@keyframes pop{0%{transform:scale(.92);opacity:0}60%{transform:scale(1.02)}100%{transform:scale(1);opacity:1}}
.app{max-width:600px;margin:0 auto;padding:0 16px 100px}
.topbar{position:sticky;top:0;z-index:40;background:rgba(250,248,244,.94);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:10px 0}
.topbar-inner{max-width:600px;margin:0 auto;padding:0 16px;display:flex;align-items:center;justify-content:space-between}
.topbar-logo{font-family:'Fraunces',serif;font-size:22px;font-weight:700;color:var(--green2)}
.topbar-level{font-size:13px;font-weight:600;color:var(--blue);background:var(--blue-bg);padding:4px 12px;border-radius:8px}
.bottomnav{position:fixed;bottom:0;left:0;right:0;z-index:50;background:rgba(255,255,255,.96);backdrop-filter:blur(12px);border-top:1px solid var(--border);padding:5px 0 calc(5px + env(safe-area-inset-bottom))}
.bottomnav-inner{max-width:600px;margin:0 auto;display:flex;justify-content:space-around}
.bnav{background:none;border:none;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:1px;padding:6px 14px;border-radius:10px;color:#aaa;font-size:10px;font-weight:600;transition:.2s}.bnav .ico{font-size:20px}.bnav.active{color:var(--green2)}.bnav:hover{background:var(--bg2)}
.screen{display:none}.screen.active{display:block;animation:fadeUp .3s ease}
.sec-title{font-family:'Fraunces',serif;font-size:24px;font-weight:700;margin-bottom:4px}
.sec-sub{font-size:14px;color:var(--text2);margin-bottom:20px}
.back-btn{background:none;border:none;cursor:pointer;font-size:14px;font-weight:600;color:var(--text2);display:flex;align-items:center;gap:6px;margin-bottom:14px;padding:4px 0}.back-btn:hover{color:var(--text)}
.unit{background:var(--card);border:1px solid var(--border);border-radius:var(--r);padding:18px 20px;margin-bottom:12px;cursor:pointer;transition:.2s;box-shadow:var(--sh)}.unit:hover{box-shadow:var(--shl);transform:translateY(-1px)}.unit.locked{opacity:.45;cursor:default;pointer-events:none}
.unit-tag{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.07em;padding:3px 10px;border-radius:8px;display:inline-block;margin-bottom:8px}
.unit h3{font-family:'Fraunces',serif;font-size:18px;font-weight:700;margin-bottom:3px}.unit p{font-size:13px;color:var(--text2);line-height:1.5}
.unit-bar{height:5px;border-radius:3px;background:var(--bg2);overflow:hidden;margin-top:12px}.unit-bar-fill{height:100%;border-radius:3px;transition:width .5s}
.unit-meta{font-size:11px;color:var(--text3);margin-top:5px;display:flex;justify-content:space-between}
.lesson-item{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px 16px;display:flex;align-items:center;gap:14px;cursor:pointer;transition:.2s;box-shadow:var(--sh);margin-bottom:8px}.lesson-item:hover{box-shadow:var(--shl)}.lesson-item.done{border-left:4px solid var(--green)}.lesson-item.locked{opacity:.4;pointer-events:none}
.lesson-icon{width:40px;height:40px;border-radius:11px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.lesson-info{flex:1}.lesson-info h4{font-size:14px;font-weight:600;margin-bottom:1px}.lesson-info p{font-size:12px;color:var(--text2)}
.ex-bar{display:flex;align-items:center;gap:12px;margin-bottom:20px}
.ex-close{background:none;border:none;cursor:pointer;font-size:20px;color:var(--text2);padding:4px}
.ex-progress{flex:1;height:8px;border-radius:4px;background:var(--bg2);overflow:hidden}.ex-progress-fill{height:100%;border-radius:4px;background:linear-gradient(90deg,var(--green),var(--teal));transition:width .4s}
.ex-step{font-size:12px;font-weight:600;color:var(--text3);white-space:nowrap}
.ex-card{animation:pop .3s ease both}
.ex-type{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.07em;margin-bottom:6px}
.ex-prompt{font-family:'Fraunces',serif;font-size:clamp(18px,4.5vw,24px);font-weight:700;line-height:1.35;margin-bottom:20px}
.ex-hint{font-size:13px;color:var(--text2);margin-top:-12px;margin-bottom:16px;font-style:italic}
.speak-btn{background:var(--blue-bg);border:2px solid transparent;border-radius:10px;padding:8px 14px;cursor:pointer;font-size:14px;font-weight:600;color:var(--blue);display:inline-flex;align-items:center;gap:6px;transition:.15s;margin-bottom:14px}.speak-btn:hover{border-color:var(--blue);background:var(--blue);color:#fff}
.spk{background:none;border:none;cursor:pointer;font-size:15px;padding:2px 4px;vertical-align:middle;opacity:.55;transition:.15s}.spk:hover{opacity:1;transform:scale(1.15)}
.options{display:flex;flex-direction:column;gap:7px;margin-bottom:16px}
.opt{width:100%;padding:14px 16px;background:var(--card);border:2px solid var(--border);border-radius:13px;cursor:pointer;font-family:'Outfit',sans-serif;font-size:15px;font-weight:500;color:var(--text);text-align:left;transition:.15s;display:flex;align-items:center;gap:11px}
.opt:hover:not(.dis){border-color:var(--blue);background:var(--blue-bg)}.opt.sel{border-color:var(--blue);background:var(--blue-bg)}.opt.ok{border-color:var(--green);background:var(--green-bg);color:var(--green2)}.opt.no{border-color:var(--red);background:var(--red-bg);color:var(--red);animation:shake .35s}.opt.dis{cursor:default}
.opt-l{width:26px;height:26px;border-radius:7px;background:var(--bg2);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:var(--text3);flex-shrink:0}
.tinput{width:100%;padding:14px 16px;background:var(--card);border:2px solid var(--border);border-radius:13px;font-family:'Outfit',sans-serif;font-size:17px;color:var(--text);outline:none;transition:.2s;margin-bottom:14px}.tinput:focus{border-color:var(--blue)}.tinput.ok{border-color:var(--green);background:var(--green-bg)}.tinput.no{border-color:var(--red);background:var(--red-bg);animation:shake .35s}
.fill-s{font-size:19px;font-weight:500;line-height:1.7;margin-bottom:18px}.fill-b{display:inline-block;min-width:80px;border-bottom:3px solid var(--blue);padding:2px 6px;margin:0 3px;font-weight:700;color:var(--blue)}
.match-g{display:grid;grid-template-columns:1fr 1fr;gap:7px;margin-bottom:16px}
.match-b{padding:12px;border-radius:11px;border:2px solid var(--border);background:var(--card);cursor:pointer;font-size:14px;font-weight:500;text-align:center;transition:.15s}.match-b:hover:not(.md):not(.sl){border-color:var(--blue)}.match-b.sl{border-color:var(--blue);background:var(--blue-bg)}.match-b.md{border-color:var(--green);background:var(--green-bg);color:var(--green2);opacity:.55;pointer-events:none}.match-b.wf{border-color:var(--red);background:var(--red-bg);animation:shake .3s}
.fb{padding:14px 16px;border-radius:13px;margin-bottom:12px;display:flex;align-items:flex-start;gap:9px;animation:fadeUp .2s ease}.fb.fok{background:var(--green-bg);border:1px solid rgba(34,197,94,.18)}.fb.fno{background:var(--red-bg);border:1px solid rgba(239,68,68,.18)}.fb-i{font-size:20px;flex-shrink:0}.fb-t{font-size:13px;line-height:1.55}.fb.fok .fb-t{color:var(--green2)}.fb.fno .fb-t{color:#b91c1c}
.btn{width:100%;padding:14px;border:none;border-radius:13px;cursor:pointer;font-family:'Outfit',sans-serif;font-size:15px;font-weight:700;transition:.2s}.btn-g{background:var(--green);color:#fff;box-shadow:0 4px 0 var(--green2)}.btn-g:hover{filter:brightness(1.05)}.btn-g:active{box-shadow:0 2px 0 var(--green2);transform:translateY(2px)}.btn-b{background:var(--blue);color:#fff;box-shadow:0 4px 0 var(--blue2)}.btn:disabled{opacity:.35;cursor:default}
.info-card{background:var(--bg2);border-radius:14px;padding:18px 20px;font-size:14.5px;line-height:1.85;white-space:pre-line;margin-bottom:18px;border-left:4px solid var(--blue)}.info-card h4{font-family:'Fraunces',serif;font-size:17px;font-weight:700;margin-bottom:8px}
.gram-card{background:var(--card);border:1px solid var(--border);border-radius:var(--r);padding:20px;margin-bottom:12px;box-shadow:var(--sh)}.gram-card h3{font-family:'Fraunces',serif;font-size:17px;font-weight:700;margin-bottom:8px}.gram-card p{font-size:14px;color:var(--text2);line-height:1.65;margin-bottom:8px;white-space:pre-line}
.gram-table{width:100%;border-collapse:collapse;font-size:13.5px;margin:8px 0}.gram-table th{text-align:left;padding:7px 10px;background:var(--bg2);font-weight:600}.gram-table td{padding:6px 10px;border-bottom:1px solid var(--border)}.gram-table tr:last-child td{border-bottom:none}
.gram-ex{background:var(--bg2);border-radius:10px;padding:10px 14px;margin-top:6px;font-size:13.5px;line-height:1.6}.gram-ex .pt{color:var(--green2);font-weight:600}.gram-ex .de{color:var(--text2);font-style:italic}
.voc-cat{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.07em;color:var(--text3);margin:18px 0 8px;padding-left:2px}
.voc-grid{display:grid;grid-template-columns:1fr 1fr;gap:7px}
.voc-card{background:var(--card);border:1px solid var(--border);border-radius:13px;padding:14px;cursor:pointer;transition:.2s;box-shadow:var(--sh);text-align:center;position:relative}.voc-card:hover{box-shadow:var(--shl)}.voc-card.fl{background:var(--green-bg);border-color:rgba(34,197,94,.25)}
.voc-w{font-family:'Fraunces',serif;font-size:18px;font-weight:700;color:var(--green2);margin-bottom:2px}.voc-d{font-size:12px;color:var(--text2)}
.voc-spk{position:absolute;top:6px;right:6px;background:none;border:none;cursor:pointer;font-size:14px;opacity:.5;padding:4px}.voc-spk:hover{opacity:1}
.slang-i{background:var(--card);border:1px solid var(--border);border-radius:13px;padding:14px 16px;margin-bottom:7px;cursor:pointer;box-shadow:var(--sh);transition:.2s}.slang-i:hover{box-shadow:var(--shl)}.slang-i.open{border-color:var(--purple)}
.slang-p{font-family:'Fraunces',serif;font-size:17px;font-weight:700;color:var(--purple)}.slang-m{font-size:13px;color:var(--text2);margin-top:1px}
.slang-d{margin-top:10px;padding-top:10px;border-top:1px solid var(--border);font-size:13px;line-height:1.7;animation:fadeUp .25s ease}.slang-d .tl{font-size:10px;font-weight:700;color:var(--purple);text-transform:uppercase;letter-spacing:.06em}.slang-d .ex{background:var(--purple-bg);border-radius:9px;padding:9px 12px;margin-top:7px;font-style:italic}
.complete{text-align:center;padding:36px 0;animation:pop .45s ease both}.complete .em{font-size:56px;margin-bottom:14px}.complete h2{font-family:'Fraunces',serif;font-size:26px;font-weight:700;margin-bottom:20px}
@media(max-width:400px){.voc-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="topbar"><div class="topbar-inner"><div class="topbar-logo">ğŸ‡§ğŸ‡· Fala!</div><div class="topbar-level" id="lvl">A1</div></div></div>
<div class="app">
<div class="screen active" id="scr-home"></div>
<div class="screen" id="scr-unit"></div>
<div class="screen" id="scr-ex"></div>
<div class="screen" id="scr-vocab"></div>
<div class="screen" id="scr-gram"></div>
<div class="screen" id="scr-slang"></div>
</div>
<nav class="bottomnav"><div class="bottomnav-inner">
<button class="bnav active" data-s="home" onclick="go('home')"><span class="ico">ğŸ“š</span>Lernen</button>
<button class="bnav" data-s="vocab" onclick="go('vocab')"><span class="ico">ğŸ”¤</span>Vokabeln</button>
<button class="bnav" data-s="gram" onclick="go('gram')"><span class="ico">ğŸ“</span>Grammatik</button>
<button class="bnav" data-s="slang" onclick="go('slang')"><span class="ico">ğŸ—£ï¸</span>GÃ­rias</button>
</div></nav>
<script src="app-data.js"></script>
<script>
function speak(t){if(!('speechSynthesis' in window))return;speechSynthesis.cancel();const u=new SpeechSynthesisUtterance(t);u.lang='pt-BR';u.rate=0.85;const v=speechSynthesis.getVoices().find(v=>v.lang.startsWith('pt'));if(v)u.voice=v;speechSynthesis.speak(u);}
if('speechSynthesis' in window)speechSynthesis.onvoiceschanged=()=>speechSynthesis.getVoices();
function spk(w,e){if(e){e.stopPropagation();e.preventDefault();}speak(w);}
const C=[
{id:'a1u1',lvl:'A1',title:'OlÃ¡! BegrÃ¼ÃŸungen',desc:'GrÃ¼ÃŸen, vorstellen, verabschieden',color:'#22c55e',bg:'#dcfce7',lessons:[
{id:'a1u1l1',title:'Hallo & TschÃ¼ss',xp:15,exercises:[
{type:'info',title:'Die drei TagesgrÃ¼ÃŸe',content:'Portugiesisch hat drei BegrÃ¼ÃŸungen:\n\nğŸŒ… <b>Bom dia</b> = Guten Morgen\nâ˜€ï¸ <b>Boa tarde</b> = Guten Nachmittag\nğŸŒ™ <b>Boa noite</b> = Guten Abend\n\nğŸ“ â€Bom" (mÃ¤nnl.) weil â€dia" mÃ¤nnl. ist\nâ€Boa" (weibl.) weil â€tarde/noite" weibl. sind\n\nğŸ‘‹ <b>OlÃ¡</b> = Hallo Â· <b>Oi</b> = Hi\nğŸ‘‹ <b>Tchau</b> = TschÃ¼ss\nğŸ‘‹ <b>AtÃ© logo</b> = Bis bald\nğŸ‘‹ <b>AtÃ© amanhÃ£</b> = Bis morgen'},
{type:'pick',prompt:'Wie sagt man â€Guten Morgen"?',options:['Boa noite','Bom dia','Boa tarde','OlÃ¡'],correct:1,audio:'Bom dia'},
{type:'pick',prompt:'Warum â€Bom dia" und nicht â€Boa dia"?',options:['Zufall','Weil â€dia" mÃ¤nnlich ist','Weil es morgens ist'],correct:1},
{type:'write',prompt:'Schreib â€Hallo" auf Portugiesisch',answer:'olÃ¡',hint:'Hat einen Akzent auf dem a'},
{type:'write',prompt:'Ãœbersetze: â€Guten Nachmittag"',answer:'boa tarde',hint:'Boa (weibl.) + Tarde'},
{type:'pick',prompt:'Was bedeutet â€AtÃ© amanhÃ£"?',options:['Bis bald','Bis morgen','Guten Tag'],correct:1,audio:'AtÃ© amanhÃ£'},
{type:'write',prompt:'Schreib â€TschÃ¼ss"',answer:'tchau',hint:'Wie â€ciao"'},
{type:'match',prompt:'Verbinde',pairs:[['Bom dia','Guten Morgen'],['Boa noite','Guten Abend'],['Tchau','TschÃ¼ss'],['AtÃ© logo','Bis bald']]},
]},
{id:'a1u1l2',title:'Wie geht es dir?',xp:15,exercises:[
{type:'info',title:'Befinden',content:'ğŸ¤ <b>Tudo bem?</b> = Alles gut?\nğŸ¤ <b>Como vai?</b> = Wie gehts?\n\nAntworten:\nâœ… <b>Tudo bem!</b> = Alles gut!\nâœ… <b>Estou bem</b> = Mir gehts gut\nâ– <b>Mais ou menos</b> = So lala\n\nğŸ“ â€Tudo bem?" ist Frage UND Antwort!'},
{type:'pick',prompt:'â€Tudo bem?" bedeutet...',options:['Wie heiÃŸt du?','Alles gut?','Danke!'],correct:1,audio:'Tudo bem?'},
{type:'write',prompt:'Antworte positiv auf â€Tudo bem?"',answer:'tudo bem',hint:'Gleiche Worte!'},
{type:'pick',prompt:'â€Mais ou menos" = ?',options:['Sehr gut','So lala','Schlecht'],correct:1,audio:'Mais ou menos'},
{type:'fill',sentence:'Como vocÃª ___?',blank:'estÃ¡',hint:'Verb â€estar"'},
{type:'write',prompt:'Ãœbersetze: â€Mir geht es gut"',answer:'estou bem',hint:'Estou + bem'},
{type:'match',prompt:'Verbinde',pairs:[['Tudo bem?','Alles gut?'],['Estou bem','Mir gehts gut'],['Mais ou menos','So lala'],['Como vai?','Wie gehts?']]},
]},
{id:'a1u1l3',title:'Sich vorstellen',xp:20,exercises:[
{type:'info',title:'Name & Herkunft',content:'ğŸ‘¤ <b>Meu nome Ã©...</b> = Mein Name ist...\nğŸ‘¤ <b>Me chamo...</b> = Ich heiÃŸe...\n\nğŸŒ <b>Eu sou da Alemanha</b> = Ich bin aus Deutschland\n\nğŸ“ PrÃ¤positionen:\nâ€¢ <b>da</b> = de+a (weibl.: a Alemanha)\nâ€¢ <b>do</b> = de+o (mÃ¤nnl.: o Brasil)\n\nğŸ¤ <b>Muito prazer!</b> = Freut mich!'},
{type:'pick',prompt:'â€Eu sou da Alemanha" = ?',options:['Ich liebe Deutschland','Ich bin aus Deutschland','Ich fahre nach Deutschland'],correct:1,audio:'Eu sou da Alemanha'},
{type:'write',prompt:'Schreib: â€Mein Name ist"',answer:'meu nome Ã©',hint:'Meu Nome Ã‰'},
{type:'fill',sentence:'Eu ___ de Berlim.',blank:'sou',hint:'Verb â€ser" fÃ¼r ich'},
{type:'write',prompt:'Ãœbersetze: â€Freut mich!"',answer:'muito prazer',hint:'Muito = sehr'},
{type:'match',prompt:'Verbinde',pairs:[['Meu nome Ã©','Mein Name ist'],['Eu sou de','Ich bin aus'],['Muito prazer','Freut mich'],['Me chamo','Ich heiÃŸe']]},
]},
]},
{id:'a1u2',lvl:'A1',title:'NÃºmeros & Cores',desc:'Zahlen 0-20, Farben, Genus',color:'#3b82f6',bg:'#dbeafe',lessons:[
{id:'a1u2l1',title:'Zahlen 0-20',xp:15,exercises:[
{type:'info',title:'Zahlen',content:'0 zero Â· 1 um Â· 2 dois Â· 3 trÃªs Â· 4 quatro Â· 5 cinco\n6 seis Â· 7 sete Â· 8 oito Â· 9 nove Â· 10 dez\n11 onze Â· 12 doze Â· 13 treze Â· 14 catorze Â· 15 quinze\n16 dezesseis Â· 17 dezessete Â· 18 dezoito Â· 19 dezenove Â· 20 vinte\n\nğŸ“ Genus: um/uma, dois/duas'},
{type:'pick',prompt:'â€Cinco" = ?',options:['3','4','5','6'],correct:2,audio:'cinco'},
{type:'write',prompt:'Zahl 7 auf Portugiesisch',answer:'sete',hint:'S-E-T-E'},
{type:'match',prompt:'Verbinde',pairs:[['trÃªs','3'],['seis','6'],['doze','12'],['vinte','20']]},
{type:'fill',sentence:'___ cafÃ©s, por favor.',blank:'dois',hint:'Zwei (mÃ¤nnl.)'},
{type:'write',prompt:'Zahl 15',answer:'quinze',hint:'Quin-ze'},
]},
{id:'a1u2l2',title:'Farben',xp:20,exercises:[
{type:'info',title:'Cores',content:'ğŸ”´ vermelho/a = rot Â· ğŸ”µ azul = blau Â· ğŸŸ¢ verde = grÃ¼n\nğŸŸ¡ amarelo/a = gelb Â· âš« preto/a = schwarz Â· âšª branco/a = weiÃŸ\n\nğŸ“ Farbe auf -o â†’ wird -a bei weibl. Nomen:\nO carro <b>vermelho</b> / A casa <b>vermelha</b>\nFarbe auf -e/-Konsonant â†’ Ã¤ndert sich nicht!'},
{type:'pick',prompt:'â€Verde" = ?',options:['Rot','GrÃ¼n','Blau'],correct:1,audio:'verde'},
{type:'match',prompt:'Verbinde',pairs:[['vermelho','rot'],['azul','blau'],['amarelo','gelb'],['preto','schwarz']]},
{type:'write',prompt:'â€WeiÃŸ" (mÃ¤nnl.)',answer:'branco',hint:'B-R-A-N-C-O'},
{type:'fill',sentence:'O cÃ©u Ã© ___.',blank:'azul',hint:'Himmel = blau'},
]},
]},
{id:'a1u3',lvl:'A1',title:'Artikel & Genus',desc:'O/A/Um/Uma, Plural, Genus-Regeln',color:'#8b5cf6',bg:'#ede9fe',lessons:[
{id:'a1u3l1',title:'Artikel',xp:20,exercises:[
{type:'info',title:'Artikel',content:'<b>Bestimmt:</b> o (der) Â· a (die) Â· os/as (Plural)\n<b>Unbestimmt:</b> um (ein) Â· uma (eine)\n\nğŸ“ Faustregel:\n-o Endung â†’ mÃ¤nnlich: o livro\n-a Endung â†’ weiblich: a casa\nâš ï¸ Ausnahmen: o dia, o mapa'},
{type:'pick',prompt:'___ casa',options:['O','A','Um'],correct:1,audio:'a casa'},
{type:'fill',sentence:'___ cafÃ©, por favor.',blank:'um',hint:'Ein Kaffee (mÃ¤nnl.)'},
{type:'match',prompt:'Verbinde',pairs:[['o','carro'],['a','mesa'],['um','cafÃ©'],['uma','cerveja']]},
{type:'write',prompt:'â€Die HÃ¤user" (Plural)',answer:'as casas',hint:'As + casas'},
{type:'fill',sentence:'___ Ã¡gua, por favor.',blank:'uma',hint:'Ãgua = weiblich!'},
]},
]},
{id:'a1u4',lvl:'A1',title:'No CafÃ©',desc:'Bestellen, Essen & Trinken',color:'#f59e0b',bg:'#fef3c7',lessons:[
{id:'a1u4l1',title:'Bestellen',xp:20,exercises:[
{type:'info',title:'Im CafÃ©',content:'â˜• <b>Um cafÃ©, por favor</b>\nğŸ’§ <b>Uma Ã¡gua</b> Â· ğŸº <b>Uma cerveja</b>\nğŸ’° <b>Quanto custa?</b> = Wie viel kostet das?\nğŸ’° <b>A conta, por favor</b> = Die Rechnung\n\nğŸ“ <b>Eu quero</b> = Ich mÃ¶chte (direkt)\n<b>Tem...?</b> = Haben Sie...?\n<b>Gostar de</b> = mÃ¶gen (immer mit de!)'},
{type:'pick',prompt:'HÃ¶flich Kaffee bestellen:',options:['Quero cafÃ©!','Um cafÃ©, por favor'],correct:1,audio:'Um cafÃ©, por favor'},
{type:'write',prompt:'â€Die Rechnung, bitte"',answer:'a conta por favor',hint:'A conta'},
{type:'fill',sentence:'___ Ã¡gua, por favor.',blank:'uma',hint:'Ãgua = weiblich'},
{type:'match',prompt:'Verbinde',pairs:[['cafÃ©','Kaffee'],['Ã¡gua','Wasser'],['cerveja','Bier'],['suco','Saft']]},
{type:'write',prompt:'â€Wie viel kostet das?"',answer:'quanto custa',hint:'Quanto = wie viel'},
]},
]},
{id:'a1u5',lvl:'A1',title:'Ser & Estar',desc:'Die zwei Verben fÃ¼r â€sein"',color:'#ef4444',bg:'#fee2e2',lessons:[
{id:'a1u5l1',title:'SER (dauerhaft)',xp:25,exercises:[
{type:'info',title:'SER',content:'<b>SER</b> = sein (dauerhaft, IdentitÃ¤t)\n\nEu <b>sou</b> Â· VocÃª <b>Ã©</b> Â· Ele/Ela <b>Ã©</b>\nNÃ³s <b>somos</b> Â· Eles <b>sÃ£o</b>\n\nVerwendung: IdentitÃ¤t, Herkunft, Beruf, Charakter'},
{type:'fill',sentence:'Eu ___ alemÃ£o.',blank:'sou',hint:'SER fÃ¼r ich'},
{type:'pick',prompt:'â€Ela Ã© professora" = ?',options:['Er ist Lehrer','Sie ist Lehrerin'],correct:1,audio:'Ela Ã© professora'},
{type:'write',prompt:'â€Wir sind Freunde"',answer:'nÃ³s somos amigos',hint:'NÃ³s somos amigos'},
{type:'match',prompt:'Konjugiere SER',pairs:[['Eu','sou'],['VocÃª','Ã©'],['NÃ³s','somos'],['Eles','sÃ£o']]},
]},
{id:'a1u5l2',title:'ESTAR (temporÃ¤r)',xp:25,exercises:[
{type:'info',title:'ESTAR',content:'<b>ESTAR</b> = sein (temporÃ¤r, Zustand, Ort)\n\nEu <b>estou</b> (tÃ´) Â· VocÃª <b>estÃ¡</b> (tÃ¡)\nNÃ³s <b>estamos</b> Â· Eles <b>estÃ£o</b>\n\nVerwendung: GefÃ¼hle, ZustÃ¤nde, Orte'},
{type:'pick',prompt:'Warum ESTAR bei â€Eu estou cansado"?',options:['Immer mÃ¼de','MÃ¼digkeit ist temporÃ¤r'],correct:1,audio:'Eu estou cansado'},
{type:'fill',sentence:'Ela ___ em casa.',blank:'estÃ¡',hint:'Ort â†’ ESTAR'},
{type:'write',prompt:'â€Ich bin mÃ¼de" (gerade)',answer:'eu estou cansado',hint:'TemporÃ¤r â†’ estou'},
{type:'match',prompt:'Konjugiere ESTAR',pairs:[['Eu','estou'],['VocÃª','estÃ¡'],['NÃ³s','estamos'],['Eles','estÃ£o']]},
]},
{id:'a1u5l3',title:'SER vs ESTAR',xp:30,exercises:[
{type:'info',title:'Vergleich',content:'<b>Selbe Adjektive, andere Bedeutung!</b>\n\nEla <b>Ã©</b> bonita = Sie IST schÃ¶n (generell)\nEla <b>estÃ¡</b> bonita = Sie SIEHT heute schÃ¶n aus\n\nğŸ“ SER â†’ Wer BIN ich? (Wesen)\nESTAR â†’ Wie FÃœHLE ich mich? Wo? (Zustand)'},
{type:'fill',sentence:'Ela ___ bonita. (generell)',blank:'Ã©',hint:'Dauerhaft = SER'},
{type:'fill',sentence:'Eu ___ cansado. (gerade)',blank:'estou',hint:'TemporÃ¤r = ESTAR'},
{type:'write',prompt:'â€Sie ist Lehrerin"',answer:'ela Ã© professora',hint:'Beruf = SER'},
{type:'match',prompt:'SER oder ESTAR?',pairs:[['Eu ___ alemÃ£o','sou'],['Eu ___ feliz (gerade)','estou'],['Ela ___ mÃ©dica','Ã©'],['Ele ___ em casa','estÃ¡']]},
]},
]},
{id:'a2u1',lvl:'A2',title:'Verbos no Presente',desc:'RegelmÃ¤ÃŸige Verben (-ar, -er, -ir)',color:'#0d9488',bg:'#ccfbf1',lessons:[
{id:'a2u1l1',title:'-AR Verben',xp:25,exercises:[
{type:'info',title:'-AR Verben',content:'<b>FALAR</b> (sprechen):\nEu fal<b>o</b> Â· VocÃª fal<b>a</b>\nNÃ³s fal<b>amos</b> Â· Eles fal<b>am</b>\n\nWeitere: morar, trabalhar, estudar, gostar, comprar, viajar'},
{type:'fill',sentence:'Eu ___ portuguÃªs.',blank:'falo',hint:'fal + o'},
{type:'write',prompt:'nÃ³s + trabalhar = ?',answer:'nÃ³s trabalhamos',hint:'-amos'},
{type:'match',prompt:'Konjugiere MORAR',pairs:[['Eu','moro'],['VocÃª','mora'],['NÃ³s','moramos'],['Eles','moram']]},
{type:'write',prompt:'â€Ich arbeite in Berlin"',answer:'eu trabalho em berlim',hint:'trabalh-o em Berlim'},
]},
{id:'a2u1l2',title:'-ER und -IR Verben',xp:25,exercises:[
{type:'info',title:'-ER/-IR',content:'<b>COMER</b>: Eu com<b>o</b> Â· VocÃª com<b>e</b> Â· NÃ³s com<b>emos</b> Â· Eles com<b>em</b>\n<b>ABRIR</b>: Eu abr<b>o</b> Â· VocÃª abr<b>e</b> Â· NÃ³s abr<b>imos</b> Â· Eles abr<b>em</b>\n\nğŸ’¡ â€Eu" ist bei ALLEN: -o!'},
{type:'fill',sentence:'Eu ___ arroz.',blank:'como',hint:'com + o'},
{type:'write',prompt:'eles + beber = ?',answer:'eles bebem',hint:'-ER: -em'},
{type:'match',prompt:'Endungen',pairs:[['-AR nÃ³s','-amos'],['-ER nÃ³s','-emos'],['-IR nÃ³s','-imos'],['Alle: eu','-o']]},
{type:'write',prompt:'â€Wir essen im Restaurant"',answer:'nÃ³s comemos no restaurante',hint:'comemos no restaurante'},
]},
]},
{id:'a2u2',lvl:'A2',title:'Possessiv & Familie',desc:'Meu/Minha, Familienmitglieder',color:'#ec4899',bg:'#fce7f3',lessons:[
{id:'a2u2l1',title:'Possessivpronomen',xp:25,exercises:[
{type:'info',title:'Mein, Dein...',content:'<b>Meu/Minha</b> = Mein(e)\nmeu carro Â· minha casa\n<b>Seu/Sua</b> = Dein(e)\n<b>Nosso/Nossa</b> = Unser(e)\n<b>Dele/Dela</b> = Sein/Ihr (eindeutig!)\n\nğŸ“ Richtet sich nach Genus des BESITZES!'},
{type:'fill',sentence:'___ nome Ã© Pedro.',blank:'meu',hint:'Name = mÃ¤nnlich'},
{type:'write',prompt:'â€unsere Stadt"',answer:'nossa cidade',hint:'Nossa + cidade'},
{type:'match',prompt:'Verbinde',pairs:[['meu carro','mein Auto'],['minha casa','mein Haus'],['nosso amigo','unser Freund'],['nossa cidade','unsere Stadt']]},
]},
{id:'a2u2l2',title:'Familie',xp:20,exercises:[
{type:'info',title:'FamÃ­lia',content:'ğŸ‘¨ pai = Vater Â· ğŸ‘© mÃ£e = Mutter\nğŸ‘¦ filho = Sohn Â· ğŸ‘§ filha = Tochter\nğŸ§‘ irmÃ£o = Bruder Â· irmÃ£ = Schwester\nğŸ‘´ avÃ´ = Opa Â· ğŸ‘µ avÃ³ = Oma\n\nğŸ“ Eu tenho = Ich habe\nEu sou casado/a = Ich bin verheiratet'},
{type:'pick',prompt:'â€MÃ£e" = ?',options:['Vater','Mutter','Oma'],correct:1,audio:'mÃ£e'},
{type:'match',prompt:'Verbinde',pairs:[['pai','Vater'],['irmÃ£o','Bruder'],['filha','Tochter'],['avÃ³','Oma']]},
{type:'fill',sentence:'Eu ___ dois irmÃ£os.',blank:'tenho',hint:'ter â†’ tenho'},
]},
]},
{id:'a2u3',lvl:'A2',title:'PretÃ©rito Perfeito',desc:'Vergangenheit',color:'#7c3aed',bg:'#ede9fe',lessons:[
{id:'a2u3l1',title:'RegelmÃ¤ÃŸig',xp:30,exercises:[
{type:'info',title:'PretÃ©rito',content:'-AR: Eu -ei Â· VocÃª -ou Â· NÃ³s -amos Â· Eles -aram\n-ER: Eu -i Â· VocÃª -eu Â· NÃ³s -emos Â· Eles -eram\n-IR: Eu -i Â· VocÃª -iu Â· NÃ³s -imos Â· Eles -iram\n\nğŸ“ NÃ³s sieht gleich aus wie PrÃ¤sens!'},
{type:'fill',sentence:'Eu ___ com ela ontem.',blank:'falei',hint:'-AR: eu = -ei'},
{type:'write',prompt:'eu + comprar (Verg.)',answer:'eu comprei',hint:'-ei'},
{type:'match',prompt:'FALAR PretÃ©rito',pairs:[['Eu','falei'],['VocÃª','falou'],['NÃ³s','falamos'],['Eles','falaram']]},
]},
{id:'a2u3l2',title:'UnregelmÃ¤ÃŸig',xp:30,exercises:[
{type:'info',title:'UnregelmÃ¤ÃŸig',content:'<b>IR/SER</b>: fui, foi, fomos, foram\n<b>TER</b>: tive, teve, tivemos\n<b>FAZER</b>: fiz, fez, fizemos\n<b>ESTAR</b>: estive, esteve\n\nğŸ“ Auswendig lernen!'},
{type:'pick',prompt:'â€Eu fui" kann heiÃŸen...',options:['Nur â€ich ging"','"ich ging" ODER â€ich war"'],correct:1,audio:'Eu fui ao cinema'},
{type:'fill',sentence:'Ela ___ ao mercado.',blank:'foi',hint:'ir â†’ foi'},
{type:'write',prompt:'eu + fazer (Verg.)',answer:'eu fiz',hint:'fiz'},
{type:'match',prompt:'Formen',pairs:[['Eu fui','ich ging/war'],['Eu tive','ich hatte'],['Eu fiz','ich machte'],['Eu estive','ich war (temp.)']]},
]},
]},
{id:'a2u4',lvl:'A2',title:'Alltag & Uhrzeit',desc:'Wochentage, Uhrzeit, Routinen',color:'#2563eb',bg:'#dbeafe',lessons:[
{id:'a2u4l1',title:'Wochentage & Uhrzeit',xp:20,exercises:[
{type:'info',title:'Tage & Uhrzeit',content:'Segunda=Mo Â· TerÃ§a=Di Â· Quarta=Mi Â· Quinta=Do Â· Sexta=Fr Â· SÃ¡bado=Sa Â· Domingo=So\n\nğŸ• Que horas sÃ£o?\nÃ‰ uma hora Â· SÃ£o duas Â· SÃ£o trÃªs e meia (3:30)'},
{type:'pick',prompt:'Quarta = ?',options:['Mo','Di','Mi','Do'],correct:2,audio:'Quarta-feira'},
{type:'match',prompt:'Tage',pairs:[['Segunda','Montag'],['Sexta','Freitag'],['SÃ¡bado','Samstag'],['Domingo','Sonntag']]},
{type:'write',prompt:'â€Wie spÃ¤t ist es?"',answer:'que horas sÃ£o',hint:'Que horas sÃ£o?'},
]},
{id:'a2u4l2',title:'Tagesablauf',xp:25,exercises:[
{type:'info',title:'Routine',content:'â˜€ï¸ Eu acordo Ã s 7h = Ich wache um 7 auf\nğŸš¿ Eu tomo banho = Ich dusche\nâ˜• Eu tomo cafÃ© da manhÃ£ = Ich frÃ¼hstÃ¼cke\nğŸ’¼ Eu trabalho das 9 Ã s 17\nğŸ˜´ Eu durmo Ã s 23h'},
{type:'fill',sentence:'Eu ___ Ã s 7 horas.',blank:'acordo',hint:'acordar â†’ acordo'},
{type:'write',prompt:'â€Ich dusche"',answer:'eu tomo banho',hint:'Tomar banho'},
{type:'match',prompt:'Verbinde',pairs:[['acordar','aufwachen'],['almoÃ§ar','Mittagessen'],['jantar','Abendessen'],['dormir','schlafen']]},
]},
]},
{id:'a2u5',lvl:'A2',title:'Futuro & PlÃ¤ne',desc:'Zukunft mit IR + Infinitiv',color:'#059669',bg:'#d1fae5',lessons:[
{id:'a2u5l1',title:'Zukunft mit IR',xp:25,exercises:[
{type:'info',title:'IR + Infinitiv',content:'Eu <b>vou</b> falar = Ich werde sprechen\nVocÃª <b>vai</b> comer\nNÃ³s <b>vamos</b> estudar\nEles <b>vÃ£o</b> trabalhar\n\nğŸ“ Standard-Zukunft im gesprochenen Brasilianisch!'},
{type:'fill',sentence:'Eu ___ estudar.',blank:'vou',hint:'ir: eu vou'},
{type:'pick',prompt:'â€NÃ³s vamos viajar" = ?',options:['Wir reisten','Wir werden reisen'],correct:1,audio:'NÃ³s vamos viajar'},
{type:'write',prompt:'â€Was wirst du machen?"',answer:'o que vocÃª vai fazer',hint:'O que + vai + fazer'},
{type:'match',prompt:'IR konjugieren',pairs:[['Eu','vou'],['VocÃª','vai'],['NÃ³s','vamos'],['Eles','vÃ£o']]},
]},
]},
];
const VOCAB={'BegrÃ¼ÃŸungen':[{pt:'OlÃ¡',de:'Hallo'},{pt:'Oi',de:'Hi'},{pt:'Bom dia',de:'Guten Morgen'},{pt:'Boa tarde',de:'Guten Nachmittag'},{pt:'Boa noite',de:'Guten Abend'},{pt:'Tchau',de:'TschÃ¼ss'},{pt:'AtÃ© logo',de:'Bis bald'}],'Grundlagen':[{pt:'Sim',de:'Ja'},{pt:'NÃ£o',de:'Nein'},{pt:'Por favor',de:'Bitte'},{pt:'Obrigado/a',de:'Danke'},{pt:'Desculpa',de:'Entschuldigung'},{pt:'Muito prazer',de:'Freut mich'}],'Essen':[{pt:'CafÃ©',de:'Kaffee'},{pt:'Ãgua',de:'Wasser'},{pt:'Cerveja',de:'Bier'},{pt:'Suco',de:'Saft'},{pt:'PÃ£o',de:'Brot'},{pt:'Comer',de:'essen'},{pt:'Beber',de:'trinken'}],'Farben':[{pt:'Vermelho',de:'Rot'},{pt:'Azul',de:'Blau'},{pt:'Verde',de:'GrÃ¼n'},{pt:'Amarelo',de:'Gelb'},{pt:'Preto',de:'Schwarz'},{pt:'Branco',de:'WeiÃŸ'}],'Zahlen':[{pt:'Um',de:'1'},{pt:'Dois',de:'2'},{pt:'TrÃªs',de:'3'},{pt:'Cinco',de:'5'},{pt:'Sete',de:'7'},{pt:'Dez',de:'10'},{pt:'Quinze',de:'15'},{pt:'Vinte',de:'20'}],'Pronomen':[{pt:'Eu',de:'Ich'},{pt:'VocÃª',de:'Du'},{pt:'Ele',de:'Er'},{pt:'Ela',de:'Sie'},{pt:'NÃ³s',de:'Wir'},{pt:'Eles',de:'Sie (Pl.)'}],'Adjektive':[{pt:'Bom',de:'Gut'},{pt:'Bonito',de:'SchÃ¶n'},{pt:'Grande',de:'GroÃŸ'},{pt:'Pequeno',de:'Klein'},{pt:'Feliz',de:'GlÃ¼cklich'},{pt:'Cansado',de:'MÃ¼de'}],'Familie':[{pt:'Pai',de:'Vater'},{pt:'MÃ£e',de:'Mutter'},{pt:'Filho',de:'Sohn'},{pt:'IrmÃ£o',de:'Bruder'},{pt:'AvÃ´',de:'Opa'},{pt:'Marido',de:'Ehemann'}],'Alltag':[{pt:'Acordar',de:'Aufwachen'},{pt:'Dormir',de:'Schlafen'},{pt:'Trabalhar',de:'Arbeiten'},{pt:'Estudar',de:'Lernen'},{pt:'Comprar',de:'Kaufen'},{pt:'Viajar',de:'Reisen'}]};
const GRAM=[{title:'ğŸ“ Artikel',content:'Bestimmt: o/a Â· Unbestimmt: um/uma\nFaustregel: -o=mÃ¤nnl., -a=weibl.',table:[['','MÃ¤nnl.','Weibl.'],['Best.','o/os','a/as'],['Unbest.','um','uma']],ex:[{pt:'O cafÃ© Ã© bom.',de:'Der Kaffee ist gut.'},{pt:'Uma cerveja, por favor.',de:'Ein Bier, bitte.'}]},{title:'ğŸ”„ SER vs ESTAR',content:'SER = dauerhaft (Wesen)\nESTAR = temporÃ¤r (Zustand, Ort)',table:[['','SER','ESTAR'],['Eu','sou','estou'],['VocÃª','Ã©','estÃ¡'],['NÃ³s','somos','estamos'],['Eles','sÃ£o','estÃ£o']],ex:[{pt:'Eu sou alemÃ£o.',de:'Ich bin Deutscher.'},{pt:'Eu estou cansado.',de:'Ich bin mÃ¼de (gerade).'}]},{title:'ğŸ“Š PrÃ¤sens',content:'-AR/-ER/-IR Endungen:',table:[['','âˆ’AR','âˆ’ER','âˆ’IR'],['Eu','âˆ’o','âˆ’o','âˆ’o'],['VocÃª','âˆ’a','âˆ’e','âˆ’e'],['NÃ³s','âˆ’amos','âˆ’emos','âˆ’imos'],['Eles','âˆ’am','âˆ’em','âˆ’em']],ex:[{pt:'Eu falo portuguÃªs.',de:'Ich spreche Portugiesisch.'},{pt:'NÃ³s comemos arroz.',de:'Wir essen Reis.'}]},{title:'â®ï¸ PretÃ©rito',content:'Vergangenheit:',table:[['','âˆ’AR','âˆ’ER','âˆ’IR'],['Eu','âˆ’ei','âˆ’i','âˆ’i'],['VocÃª','âˆ’ou','âˆ’eu','âˆ’iu'],['NÃ³s','âˆ’amos','âˆ’emos','âˆ’imos'],['Eles','âˆ’aram','âˆ’eram','âˆ’iram']],ex:[{pt:'Eu falei com ela.',de:'Ich sprach mit ihr.'}]},{title:'ğŸ”® Futur',content:'IR + Infinitiv:',table:[['','IR'],['Eu','vou'],['VocÃª','vai'],['NÃ³s','vamos'],['Eles','vÃ£o']],ex:[{pt:'Eu vou viajar.',de:'Ich werde reisen.'}]},{title:'ğŸš« Verneinung',content:'NÃ£o VOR das Verb!',table:null,ex:[{pt:'Eu nÃ£o falo inglÃªs.',de:'Ich spreche kein Englisch.'}]},{title:'â“ Fragen',content:'Satzstellung Ã¤ndert sich nicht!\nQuem, O que, Onde, Quando, Por que, Como, Quanto',table:null,ex:[{pt:'Onde vocÃª mora?',de:'Wo wohnst du?'}]},{title:'ğŸ‘« Possessiv',content:'Richtet sich nach Genus des Besitzes:',table:[['','M','W'],['Mein','meu','minha'],['Dein','seu','sua'],['Unser','nosso','nossa']],ex:[{pt:'Meu carro.',de:'Mein Auto.'},{pt:'Minha casa.',de:'Mein Haus.'}]}];
const SLANG=[{phrase:"E aÃ­?",meaning:"Was geht?",tone:"LÃ¤ssig",example:"E aÃ­, mano?"},{phrase:"Beleza!",meaning:"Alles klar!",tone:"Zustimmend",example:"Beleza, vamos!"},{phrase:"Cara/Mano",meaning:"Alter/Kumpel",tone:"Wie Dude",example:"Cara, sÃ©rio?"},{phrase:"TÃ¡ ligado?",meaning:"WeiÃŸt du?",tone:"Jugendlich",example:"TÃ¡ ligado, mano?"},{phrase:"Valeu!",meaning:"Danke/TschÃ¼ss",tone:"Informell",example:"Valeu, falou!"},{phrase:"Que massa!",meaning:"Wie geil!",tone:"Begeistert",example:"Que massa!"},{phrase:"TÃ´ nem aÃ­",meaning:"Juckt mich nicht",tone:"GleichgÃ¼ltig",example:"TÃ´ nem aÃ­."},{phrase:"PÃ´!",meaning:"Mensch!",tone:"Frustration",example:"PÃ´, esqueci!"},{phrase:"Saudade",meaning:"Sehnsucht",tone:"Emotional",example:"Saudade de vocÃª."},{phrase:"Gata/Gato",meaning:"HÃ¼bsche/r",tone:"Flirty",example:"Olha aquela gata!"},{phrase:"Falou!",meaning:"Abgemacht!",tone:"LÃ¤ssig",example:"AmanhÃ£, falou!"},{phrase:"Caramba!",meaning:"Wow!",tone:"Ãœberrascht",example:"Caramba!"},{phrase:"Pode crer!",meaning:"Stimmt!",tone:"BestÃ¤tigend",example:"Pode crer!"},{phrase:"TÃ´ de boa",meaning:"Ich chill",tone:"Relaxed",example:"TÃ´ de boa."},{phrase:"MermÃ£o",meaning:"Bruder",tone:"Rio-Slang",example:"MermÃ£o!"},{phrase:"Suave",meaning:"Easy",tone:"Gelassen",example:"Suave!"},{phrase:"Partiu!",meaning:"Los!",tone:"Aufbruch",example:"Partiu praia!"},{phrase:"Vacilou",meaning:"Fail",tone:"Spielerisch",example:"Vacilou!"},{phrase:"Bora!",meaning:"Komm!",tone:"Energisch",example:"Bora!"},{phrase:"Zoar",meaning:"Verarschen",tone:"Kumpels",example:"Para de zoar!"}];
// STATE
let S={scr:'home',done:{},curU:null,curL:null,exIdx:0,sel:null,ans:false,ms:null,_wv:null,_wc:null,flipV:{},openSl:-1};

// NAV
function go(s){S.scr=s;document.querySelectorAll('.screen').forEach(x=>x.classList.remove('active'));document.getElementById('scr-'+s).classList.add('active');document.querySelectorAll('.bnav').forEach(b=>b.classList.toggle('active',b.dataset.s===s));rr();}
function rr(){
  const d=Object.keys(S.done).length,t=C.reduce((s,u)=>s+u.lessons.length,0);
  document.getElementById('lvl').textContent=d>=t*0.5?'A2':'A1';
  if(S.scr==='home')rHome();else if(S.scr==='unit')rUnit();else if(S.scr==='ex')rEx();else if(S.scr==='vocab')rVocab();else if(S.scr==='gram')rGram();else if(S.scr==='slang')rSlang();
}

// HOME
function rHome(){
  const c=document.getElementById('scr-home');
  let h='<div style="margin:18px 0 22px"><h2 class="sec-title">Dein Lernpfad</h2><p class="sec-sub">A1 â†’ A2 strukturiert wie ein Lehrbuch</p></div>';
  C.forEach((u,ui)=>{
    const done=u.lessons.filter(l=>S.done[l.id]).length;
    const pct=Math.round((done/u.lessons.length)*100);
    const locked=ui>0&&!C[ui-1].lessons.every(l=>S.done[l.id]);
    h+='<div class="unit'+(locked?' locked':'')+'" onclick="'+(locked?'':'openU(\''+u.id+'\')')+'">';
    h+='<span class="unit-tag" style="background:'+u.bg+';color:'+u.color+'">'+u.lvl+' Â· Einheit '+(ui+1)+'</span>';
    if(locked)h+='<span style="float:right;font-size:18px">ğŸ”’</span>';
    else if(done===u.lessons.length)h+='<span style="float:right;font-size:18px">âœ…</span>';
    h+='<h3>'+u.title+'</h3><p>'+u.desc+'</p>';
    h+='<div class="unit-bar"><div class="unit-bar-fill" style="width:'+pct+'%;background:'+u.color+'"></div></div>';
    h+='<div class="unit-meta"><span>'+done+'/'+u.lessons.length+' Lektionen</span><span>'+pct+'%</span></div></div>';
  });
  c.innerHTML=h;
}
function openU(uid){S.curU=uid;S.scr='unit';document.querySelectorAll('.screen').forEach(x=>x.classList.remove('active'));document.getElementById('scr-unit').classList.add('active');rr();}

// UNIT
function rUnit(){
  const u=C.find(x=>x.id===S.curU);if(!u)return;
  const c=document.getElementById('scr-unit');
  let h='<button class="back-btn" onclick="go(\'home\')">â† ZurÃ¼ck</button>';
  h+='<span class="unit-tag" style="background:'+u.bg+';color:'+u.color+';margin-bottom:10px">'+u.lvl+'</span>';
  h+='<h2 class="sec-title">'+u.title+'</h2><p class="sec-sub">'+u.desc+'</p>';
  u.lessons.forEach((l,li)=>{
    const done=S.done[l.id];const prev=li===0||S.done[u.lessons[li-1].id];const locked=!prev&&li>0;
    h+='<div class="lesson-item'+(done?' done':'')+(locked?' locked':'')+'" onclick="'+(locked?'':'startL(\''+u.id+'\',\''+l.id+'\')')+'">';
    h+='<div class="lesson-icon" style="background:'+(done?u.bg:'#f5f5f5')+'">'+(locked?'ğŸ”’':'ğŸ“')+'</div>';
    h+='<div class="lesson-info"><h4>'+l.title+'</h4><p>'+l.exercises.length+' Ãœbungen</p></div>';
    if(done)h+='<span style="color:var(--green);font-size:18px">âœ“</span>';
    h+='</div>';
  });
  c.innerHTML=h;
}

// START LESSON
function startL(uid,lid){
  S.curU=uid;S.curL=lid;S.exIdx=0;S.sel=null;S.ans=false;S.ms=null;S._wv=null;S._wc=null;
  S.scr='ex';document.querySelectorAll('.screen').forEach(x=>x.classList.remove('active'));document.getElementById('scr-ex').classList.add('active');rr();
}
function getL(){const u=C.find(x=>x.id===S.curU);return u?u.lessons.find(l=>l.id===S.curL):null;}

// EXERCISE
function rEx(){
  const l=getL();if(!l)return;const exs=l.exercises,ex=exs[S.exIdx];
  if(!ex){showDone();return;}
  const c=document.getElementById('scr-ex');
  const pct=((S.exIdx)/exs.length)*100;
  let body='';
  if(ex.type==='info')body=rInfo(ex);
  else if(ex.type==='pick')body=rPick(ex);
  else if(ex.type==='write')body=rWrite(ex);
  else if(ex.type==='fill')body=rFill(ex);
  else if(ex.type==='match')body=rMatch(ex);
  c.innerHTML='<div style="padding-top:10px"><div class="ex-bar"><button class="ex-close" onclick="exitL()">âœ•</button><div class="ex-progress"><div class="ex-progress-fill" style="width:'+pct+'%"></div></div><span class="ex-step">'+(S.exIdx+1)+'/'+exs.length+'</span></div><div class="ex-card">'+body+'</div></div>';
}

function rInfo(ex){
  return '<div class="ex-type" style="color:var(--blue)">ğŸ“– Lektion</div><div class="info-card"><h4>'+ex.title+'</h4>'+ex.content+'</div><button class="btn btn-g" onclick="nxt()">Verstanden â€“ Weiter â†’</button>';
}

function rPick(ex){
  let fb='';
  if(S.ans){const ok=S.sel===ex.correct;fb='<div class="fb '+(ok?'fok':'fno')+'"><span class="fb-i">'+(ok?'âœ…':'âŒ')+'</span><div class="fb-t"><strong>'+(ok?'Richtig!':'Falsch!')+'</strong>'+(!ok?' Richtig: <b>'+ex.options[ex.correct]+'</b>':'')+'</div></div>';}
  let h='<div class="ex-type" style="color:var(--green2)">WÃ¤hle die richtige Antwort</div>';
  h+='<h3 class="ex-prompt">'+ex.prompt+(ex.audio?' <button class="spk" onclick="spk(\''+esc(ex.audio)+'\',event)" title="AnhÃ¶ren">ğŸ”Š</button>':'')+'</h3>';
  h+='<div class="options">';
  ex.options.forEach((o,i)=>{
    let cls='opt';
    if(S.ans){cls+=' dis';if(i===ex.correct)cls+=' ok';else if(i===S.sel&&i!==ex.correct)cls+=' no';}
    else if(S.sel===i)cls+=' sel';
    h+='<button class="'+cls+'" onclick="pick('+i+')"><span class="opt-l">'+String.fromCharCode(65+i)+'</span>'+o+'</button>';
  });
  h+='</div>'+fb;
  if(S.ans)h+='<button class="btn btn-b" onclick="nxt()">Weiter â†’</button>';
  else if(S.sel!==null)h+='<button class="btn btn-g" onclick="chkP()">PrÃ¼fen</button>';
  else h+='<button class="btn btn-g" disabled>WÃ¤hle eine Antwort</button>';
  return h;
}

function rWrite(ex){
  let fb='';
  if(S.ans){const ok=S._wc;fb='<div class="fb '+(ok?'fok':'fno')+'"><span class="fb-i">'+(ok?'âœ…':'âŒ')+'</span><div class="fb-t"><strong>'+(ok?'Richtig!':'Nicht ganz.')+'</strong>'+(!ok?' Richtig: <b>'+ex.answer+'</b>':'')+'</div></div>';}
  let h='<div class="ex-type" style="color:var(--amber)">âœï¸ Schreib die Antwort</div>';
  h+='<h3 class="ex-prompt">'+ex.prompt+'</h3>';
  if(ex.hint)h+='<p class="ex-hint">ğŸ’¡ '+ex.hint+'</p>';
  h+='<input class="tinput'+(S.ans?(S._wc?' ok':' no'):'')+'" id="winp" placeholder="Deine Antwort..." '+(S.ans?'disabled':'')+' onkeydown="if(event.key===\'Enter\')chkW()" value="'+(S.ans?(S._wv||''):'')+'">'+fb;
  h+=S.ans?'<button class="btn btn-b" onclick="nxt()">Weiter â†’</button>':'<button class="btn btn-g" onclick="chkW()">PrÃ¼fen</button>';
  return h;
}

function rFill(ex){
  let fb='';
  if(S.ans){const ok=S._wc;fb='<div class="fb '+(ok?'fok':'fno')+'"><span class="fb-i">'+(ok?'âœ…':'âŒ')+'</span><div class="fb-t"><strong>'+(ok?'Richtig!':'Nicht ganz.')+'</strong>'+(!ok?' Richtig: <b>'+ex.blank+'</b>':'')+'</div></div>';}
  const pts=ex.sentence.split('___');
  let h='<div class="ex-type" style="color:var(--teal)">ğŸ“ FÃ¼lle die LÃ¼cke</div>';
  h+='<div class="fill-s">'+pts[0]+'<span class="fill-b">'+(S.ans?S._wv:'?')+'</span>'+(pts[1]||'')+'</div>';
  if(ex.hint)h+='<p class="ex-hint">ğŸ’¡ '+ex.hint+'</p>';
  h+='<input class="tinput'+(S.ans?(S._wc?' ok':' no'):'')+'" id="finp" placeholder="Fehlendes Wort..." '+(S.ans?'disabled':'')+' onkeydown="if(event.key===\'Enter\')chkF()" value="'+(S.ans?(S._wv||''):'')+'">'+fb;
  h+=S.ans?'<button class="btn btn-b" onclick="nxt()">Weiter â†’</button>':'<button class="btn btn-g" onclick="chkF()">PrÃ¼fen</button>';
  return h;
}

function rMatch(ex){
  if(!S.ms){
    const r=ex.pairs.map((p,i)=>({t:p[1],idx:i}));
    for(let i=r.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[r[i],r[j]]=[r[j],r[i]];}
    S.ms={right:r,matched:[],sel:null,wf:null};
  }
  const ms=S.ms,allDone=ms.matched.length===ex.pairs.length;
  let h='<div class="ex-type" style="color:var(--purple)">ğŸ”— Verbinde die Paare</div><h3 class="ex-prompt">'+ex.prompt+'</h3><div class="match-g"><div>';
  ex.pairs.forEach((p,i)=>{
    const m=ms.matched.includes(i),s=ms.sel&&ms.sel.side==='l'&&ms.sel.idx===i;
    h+='<div class="match-b'+(m?' md':'')+(s?' sl':'')+'" style="margin-bottom:7px" onclick="mClk(\'l\','+i+')">'+p[0]+' <button class="spk" onclick="spk(\''+esc(p[0])+'\',event)">ğŸ”Š</button></div>';
  });
  h+='</div><div>';
  ms.right.forEach(item=>{
    const m=ms.matched.includes(item.idx),s=ms.sel&&ms.sel.side==='r'&&ms.sel.idx===item.idx,w=ms.wf&&ms.wf.side==='r'&&ms.wf.idx===item.idx;
    h+='<div class="match-b'+(m?' md':'')+(s?' sl':'')+(w?' wf':'')+'" style="margin-bottom:7px" onclick="mClk(\'r\','+item.idx+')">'+item.t+'</div>';
  });
  h+='</div></div>';
  if(allDone)h+='<div class="fb fok"><span class="fb-i">âœ…</span><div class="fb-t"><strong>Alle richtig!</strong></div></div><button class="btn btn-b" onclick="nxt()">Weiter â†’</button>';
  return h;
}

// Escape quotes for onclick
function esc(s){return s.replace(/'/g,"\\'").replace(/"/g,'&quot;');}

// LOGIC
function pick(i){if(S.ans)return;S.sel=i;rr();}
function chkP(){S.ans=true;rr();}
function chkW(){const inp=document.getElementById('winp');if(!inp||!inp.value.trim())return;const l=getL(),ex=l.exercises[S.exIdx];S._wv=inp.value.trim();S._wc=S._wv.toLowerCase().replace(/[?.!,]/g,'').trim()===ex.answer.toLowerCase().replace(/[?.!,]/g,'').trim();S.ans=true;rr();}
function chkF(){const inp=document.getElementById('finp');if(!inp||!inp.value.trim())return;const l=getL(),ex=l.exercises[S.exIdx];S._wv=inp.value.trim();S._wc=S._wv.toLowerCase().trim()===ex.blank.toLowerCase().trim();S.ans=true;rr();}
function mClk(side,idx){
  const ms=S.ms;if(!ms)return;
  if(side==='l'&&ms.matched.includes(idx))return;
  if(side==='r'&&ms.matched.includes(idx))return;
  if(!ms.sel){ms.sel={side,idx};rr();}
  else if(ms.sel.side===side){ms.sel={side,idx};rr();}
  else{
    const li=side==='l'?idx:ms.sel.idx,ri=side==='r'?idx:ms.sel.idx;
    if(li===ri){ms.matched.push(li);ms.sel=null;rr();}
    else{ms.wf={side,idx};rr();setTimeout(()=>{ms.wf=null;ms.sel=null;rr();},500);}
  }
}
function nxt(){S.exIdx++;S.sel=null;S.ans=false;S.ms=null;S._wv=null;S._wc=null;rr();}
function exitL(){S.scr='unit';S.ms=null;document.querySelectorAll('.screen').forEach(x=>x.classList.remove('active'));document.getElementById('scr-unit').classList.add('active');rr();}
function showDone(){
  const l=getL();S.done[l.id]=true;
  document.getElementById('scr-ex').innerHTML='<div class="complete"><div class="em">ğŸ‰</div><h2>Lektion abgeschlossen!</h2><p style="color:var(--text2);margin-bottom:24px">'+l.title+'</p><button class="btn btn-g" style="max-width:280px;margin:0 auto" onclick="go(\'unit\')">Weiter lernen â†’</button></div>';
  rr();
}

// VOCAB
function rVocab(){
  const c=document.getElementById('scr-vocab');
  let h='<div style="margin:18px 0 18px"><h2 class="sec-title">ğŸ”¤ Vokabeln</h2><p class="sec-sub">Klick zum Aufdecken Â· ğŸ”Š zum AnhÃ¶ren</p></div>';
  Object.entries(VOCAB).forEach(([cat,words])=>{
    h+='<div class="voc-cat">'+cat+'</div><div class="voc-grid">';
    words.forEach((w,i)=>{
      const k=cat+i,fl=S.flipV[k];
      h+='<div class="voc-card'+(fl?' fl':'')+'" onclick="flipV(\''+k+'\')"><button class="voc-spk" onclick="spk(\''+esc(w.pt)+'\',event)" title="AnhÃ¶ren">ğŸ”Š</button><div class="voc-w">'+w.pt+'</div><div class="voc-d">'+(fl?w.de:'â€¢ â€¢ â€¢')+'</div></div>';
    });
    h+='</div>';
  });
  c.innerHTML=h;
}
function flipV(k){S.flipV[k]=!S.flipV[k];rVocab();}

// GRAMMAR
function rGram(){
  const c=document.getElementById('scr-gram');
  let h='<div style="margin:18px 0 18px"><h2 class="sec-title">ğŸ“ Grammatik</h2><p class="sec-sub">AusfÃ¼hrlich wie im Lehrbuch</p></div>';
  GRAM.forEach(g=>{
    h+='<div class="gram-card"><h3>'+g.title+'</h3><p>'+g.content+'</p>';
    if(g.table)h+='<table class="gram-table">'+g.table.map((r,ri)=>'<tr>'+r.map(c=>ri===0?'<th>'+c+'</th>':'<td>'+c+'</td>').join('')+'</tr>').join('')+'</table>';
    g.ex.forEach(e=>h+='<div class="gram-ex"><span class="pt">'+e.pt+'</span> <button class="spk" onclick="spk(\''+esc(e.pt)+'\',event)">ğŸ”Š</button><br><span class="de">â†’ '+e.de+'</span></div>');
    h+='</div>';
  });
  c.innerHTML=h;
}

// SLANG
function rSlang(){
  const c=document.getElementById('scr-slang');
  let h='<div style="margin:18px 0 18px"><h2 class="sec-title">ğŸ—£ï¸ GÃ­rias Brasileiras</h2><p class="sec-sub">20 echte Slang-AusdrÃ¼cke</p></div>';
  SLANG.forEach((s,i)=>{
    const open=S.openSl===i;
    h+='<div class="slang-i'+(open?' open':'')+'" onclick="togSl('+i+')">';
    h+='<div style="display:flex;justify-content:space-between;align-items:center"><div><div class="slang-p">â€'+s.phrase+'" <button class="spk" onclick="spk(\''+esc(s.phrase)+'\',event)">ğŸ”Š</button></div><div class="slang-m">â†’ '+s.meaning+'</div></div>';
    h+='<span style="color:var(--purple);font-size:11px;transition:.3s;'+(open?'transform:rotate(180deg)':'')+'">â–¾</span></div>';
    if(open)h+='<div class="slang-d"><div class="tl">Ton</div><p>'+s.tone+'</p><div class="ex"><b>Beispiel:</b> '+s.example+'</div></div>';
    h+='</div>';
  });
  c.innerHTML=h;
}
function togSl(i){S.openSl=S.openSl===i?-1:i;rSlang();}

// INIT
rr();
</script></body></html>
