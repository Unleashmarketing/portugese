<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fala! â€“ Portugiesisch lernen</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Fraunces:opsz,wght@9..144,400;9..144,700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #faf8f4;
  --bg2: #f0ede6;
  --card: #ffffff;
  --text: #1a1a1a;
  --text2: #6b6560;
  --green: #22c55e;
  --green2: #16a34a;
  --green-bg: #dcfce7;
  --blue: #3b82f6;
  --blue-bg: #dbeafe;
  --amber: #f59e0b;
  --amber-bg: #fef3c7;
  --red: #ef4444;
  --red-bg: #fee2e2;
  --purple: #8b5cf6;
  --purple-bg: #ede9fe;
  --teal: #14b8a6;
  --border: #e8e4de;
  --shadow: 0 1px 3px rgba(0,0,0,0.06), 0 4px 12px rgba(0,0,0,0.04);
  --shadow-lg: 0 4px 20px rgba(0,0,0,0.08);
  --radius: 16px;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'Outfit', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}
@keyframes fadeUp { from { opacity:0; transform:translateY(14px); } to { opacity:1; transform:translateY(0); } }
@keyframes pop { 0% { transform:scale(0.9); opacity:0; } 50% { transform:scale(1.03); } 100% { transform:scale(1); opacity:1; } }
@keyframes shake { 0%,100% { transform:translateX(0); } 20%,60% { transform:translateX(-6px); } 40%,80% { transform:translateX(6px); } }
@keyframes slideRight { from { transform:translateX(-100%); } to { transform:translateX(0); } }
@keyframes confetti { 0% { transform:translateY(0) rotate(0); opacity:1; } 100% { transform:translateY(-60px) rotate(360deg); opacity:0; } }
@keyframes pulse { 0%,100% { transform:scale(1); } 50% { transform:scale(1.05); } }
.animate { animation: fadeUp 0.4s ease both; }

/* â”€â”€â”€ APP SHELL â”€â”€â”€ */
.app { max-width: 520px; margin: 0 auto; padding: 0 16px 100px; }

/* â”€â”€â”€ TOP BAR â”€â”€â”€ */
.topbar {
  position: sticky; top: 0; z-index: 40;
  background: rgba(250,248,244,0.92);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  padding: 12px 0; margin-bottom: 8px;
  border-bottom: 1px solid var(--border);
}
.topbar-inner {
  display: flex; align-items: center; justify-content: space-between;
  max-width: 520px; margin: 0 auto; padding: 0 16px;
}
.topbar-logo {
  font-family: 'Fraunces', serif;
  font-size: 22px; font-weight: 700; color: var(--green2);
  display: flex; align-items: center; gap: 6px;
}
.topbar-stats { display: flex; gap: 16px; align-items: center; }
.stat {
  display: flex; align-items: center; gap: 5px;
  font-size: 14px; font-weight: 600;
}
.stat-icon { font-size: 18px; }
.stat .xp { color: var(--amber); }
.stat .streak { color: var(--red); }
.stat .level { color: var(--blue); }

/* â”€â”€â”€ BOTTOM NAV â”€â”€â”€ */
.bottomnav {
  position: fixed; bottom: 0; left: 0; right: 0;
  z-index: 50;
  background: rgba(255,255,255,0.95);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  border-top: 1px solid var(--border);
  padding: 6px 0 calc(6px + env(safe-area-inset-bottom));
}
.bottomnav-inner {
  max-width: 520px; margin: 0 auto;
  display: flex; justify-content: space-around;
}
.bnav-btn {
  background: none; border: none; cursor: pointer;
  display: flex; flex-direction: column; align-items: center; gap: 2px;
  padding: 6px 12px; border-radius: 12px;
  transition: all 0.2s; color: #aaa; font-size: 11px; font-weight: 600;
}
.bnav-btn .ico { font-size: 22px; }
.bnav-btn.active { color: var(--green2); }
.bnav-btn:hover { background: var(--bg2); }

/* â”€â”€â”€ SCREENS â”€â”€â”€ */
.screen { display: none; }
.screen.active { display: block; animation: fadeUp 0.35s ease; }

/* â”€â”€â”€ HOME / UNIT MAP â”€â”€â”€ */
.unit {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 20px;
  margin-bottom: 14px; cursor: pointer;
  transition: all 0.2s; box-shadow: var(--shadow);
}
.unit:hover { box-shadow: var(--shadow-lg); transform: translateY(-1px); }
.unit.locked { opacity: 0.5; cursor: default; pointer-events: none; }
.unit.locked:hover { box-shadow: var(--shadow); transform: none; }
.unit-top { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
.unit-num {
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.08em; padding: 3px 10px; border-radius: 8px;
}
.unit-lock { font-size: 20px; }
.unit h3 {
  font-family: 'Fraunces', serif;
  font-size: 19px; font-weight: 700; margin-bottom: 4px;
}
.unit p { font-size: 13px; color: var(--text2); line-height: 1.5; }
.unit-progress { margin-top: 12px; }
.unit-bar {
  height: 6px; border-radius: 3px; background: var(--bg2); overflow: hidden;
}
.unit-bar-fill {
  height: 100%; border-radius: 3px; transition: width 0.6s ease;
}
.unit-label {
  font-size: 11px; color: var(--text2); margin-top: 5px;
  display: flex; justify-content: space-between;
}

/* â”€â”€â”€ LESSON LIST â”€â”€â”€ */
.lesson-list { display: flex; flex-direction: column; gap: 8px; }
.back-btn {
  background: none; border: none; cursor: pointer;
  font-size: 14px; font-weight: 600; color: var(--text2);
  display: flex; align-items: center; gap: 6px;
  margin-bottom: 16px; padding: 4px 0;
}
.back-btn:hover { color: var(--text); }
.lesson-item {
  background: var(--card); border: 1px solid var(--border);
  border-radius: 14px; padding: 16px 18px;
  display: flex; align-items: center; gap: 14px;
  cursor: pointer; transition: all 0.2s;
  box-shadow: var(--shadow);
}
.lesson-item:hover { box-shadow: var(--shadow-lg); }
.lesson-item.done { border-left: 4px solid var(--green); }
.lesson-item.locked { opacity: 0.45; pointer-events: none; }
.lesson-icon {
  width: 42px; height: 42px; border-radius: 12px;
  display: flex; align-items: center; justify-content: center;
  font-size: 20px; flex-shrink: 0;
}
.lesson-info { flex: 1; }
.lesson-info h4 { font-size: 15px; font-weight: 600; margin-bottom: 2px; }
.lesson-info p { font-size: 12px; color: var(--text2); }
.lesson-check { font-size: 20px; color: var(--green); }

/* â”€â”€â”€ EXERCISE VIEW â”€â”€â”€ */
.exercise-bar {
  display: flex; align-items: center; gap: 12px; margin-bottom: 24px;
}
.exercise-close {
  background: none; border: none; cursor: pointer;
  font-size: 22px; color: var(--text2); padding: 4px;
}
.exercise-progress {
  flex: 1; height: 10px; border-radius: 5px;
  background: var(--bg2); overflow: hidden;
}
.exercise-progress-fill {
  height: 100%; border-radius: 5px;
  background: linear-gradient(90deg, var(--green), var(--teal));
  transition: width 0.4s ease;
}
.exercise-hearts { display: flex; gap: 2px; font-size: 18px; }

.exercise-card {
  animation: pop 0.35s ease both;
}
.exercise-type {
  font-size: 12px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.08em; margin-bottom: 8px;
}
.exercise-prompt {
  font-family: 'Fraunces', serif;
  font-size: clamp(20px, 5vw, 26px);
  font-weight: 700; line-height: 1.35;
  margin-bottom: 24px;
}
.exercise-hint {
  font-size: 13px; color: var(--text2);
  margin-top: -16px; margin-bottom: 20px;
  font-style: italic;
}

/* Options */
.options { display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px; }
.option-btn {
  width: 100%; padding: 15px 18px;
  background: var(--card); border: 2px solid var(--border);
  border-radius: 14px; cursor: pointer;
  font-family: 'Outfit', sans-serif;
  font-size: 16px; font-weight: 500; color: var(--text);
  text-align: left; transition: all 0.15s;
  display: flex; align-items: center; gap: 12px;
}
.option-btn:hover:not(.disabled) { border-color: var(--blue); background: var(--blue-bg); }
.option-btn.selected { border-color: var(--blue); background: var(--blue-bg); }
.option-btn.correct { border-color: var(--green); background: var(--green-bg); color: var(--green2); }
.option-btn.wrong { border-color: var(--red); background: var(--red-bg); color: var(--red); animation: shake 0.4s; }
.option-btn.disabled { cursor: default; }
.option-letter {
  width: 28px; height: 28px; border-radius: 8px;
  background: var(--bg2); display: flex; align-items: center; justify-content: center;
  font-size: 13px; font-weight: 700; color: var(--text2); flex-shrink: 0;
}

/* Text input */
.text-input-wrap { margin-bottom: 20px; }
.text-input {
  width: 100%; padding: 16px 18px;
  background: var(--card); border: 2px solid var(--border);
  border-radius: 14px; font-family: 'Outfit', sans-serif;
  font-size: 18px; color: var(--text); outline: none;
  transition: border-color 0.2s;
}
.text-input:focus { border-color: var(--blue); }
.text-input.correct { border-color: var(--green); background: var(--green-bg); }
.text-input.wrong { border-color: var(--red); background: var(--red-bg); animation: shake 0.4s; }

/* Match pairs */
.match-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
  margin-bottom: 20px;
}
.match-btn {
  padding: 14px; border-radius: 12px;
  border: 2px solid var(--border);
  background: var(--card); cursor: pointer;
  font-family: 'Outfit', sans-serif;
  font-size: 15px; font-weight: 500;
  text-align: center; transition: all 0.15s;
}
.match-btn:hover:not(.matched):not(.sel) { border-color: var(--blue); }
.match-btn.sel { border-color: var(--blue); background: var(--blue-bg); }
.match-btn.matched { border-color: var(--green); background: var(--green-bg); color: var(--green2); opacity: 0.6; pointer-events: none; }
.match-btn.wrong-flash { border-color: var(--red); background: var(--red-bg); animation: shake 0.3s; }

/* Word bank */
.word-bank { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; min-height: 52px;
  padding: 12px; border: 2px dashed var(--border); border-radius: 14px; background: var(--bg2); }
.word-source { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; }
.word-chip {
  padding: 10px 16px; border-radius: 10px;
  border: 2px solid var(--border); background: var(--card);
  cursor: pointer; font-family: 'Outfit', sans-serif;
  font-size: 15px; font-weight: 500; transition: all 0.15s;
}
.word-chip:hover { border-color: var(--blue); }
.word-chip.placed { opacity: 0.3; pointer-events: none; }
.word-chip.in-bank { background: var(--blue-bg); border-color: var(--blue); }

/* Check button */
.check-btn {
  width: 100%; padding: 16px;
  border: none; border-radius: 14px; cursor: pointer;
  font-family: 'Outfit', sans-serif;
  font-size: 16px; font-weight: 700;
  transition: all 0.2s;
}
.check-btn.primary {
  background: var(--green); color: white;
  box-shadow: 0 4px 0 var(--green2);
}
.check-btn.primary:hover { filter: brightness(1.05); }
.check-btn.primary:active { box-shadow: 0 2px 0 var(--green2); transform: translateY(2px); }
.check-btn:disabled { opacity: 0.4; cursor: default; }
.check-btn.next {
  background: var(--blue); color: white;
  box-shadow: 0 4px 0 #2563eb;
}

/* Feedback bar */
.feedback {
  padding: 16px 18px; border-radius: 14px;
  margin-bottom: 14px; display: flex; align-items: flex-start; gap: 10px;
  animation: fadeUp 0.25s ease;
}
.feedback.correct { background: var(--green-bg); border: 1px solid rgba(34,197,94,0.2); }
.feedback.wrong { background: var(--red-bg); border: 1px solid rgba(239,68,68,0.2); }
.feedback .fb-icon { font-size: 22px; flex-shrink: 0; }
.feedback .fb-text { font-size: 14px; line-height: 1.5; }
.feedback .fb-text strong { display: block; margin-bottom: 2px; }
.feedback.correct .fb-text { color: var(--green2); }
.feedback.wrong .fb-text { color: #b91c1c; }

/* â”€â”€â”€ LESSON COMPLETE â”€â”€â”€ */
.complete-screen {
  text-align: center; padding: 40px 0;
  animation: pop 0.5s ease both;
}
.complete-emoji { font-size: 64px; margin-bottom: 16px; }
.complete-screen h2 {
  font-family: 'Fraunces', serif;
  font-size: 28px; font-weight: 700; margin-bottom: 6px;
}
.complete-screen .sub { font-size: 15px; color: var(--text2); margin-bottom: 28px; }
.complete-stats {
  display: flex; justify-content: center; gap: 24px; margin-bottom: 32px;
}
.complete-stat {
  text-align: center;
}
.complete-stat .val {
  font-size: 28px; font-weight: 700;
}
.complete-stat .lbl { font-size: 12px; color: var(--text2); margin-top: 2px; }

/* â”€â”€â”€ VOCAB SCREEN â”€â”€â”€ */
.vocab-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
}
.vocab-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: 14px; padding: 16px;
  cursor: pointer; transition: all 0.2s;
  box-shadow: var(--shadow); text-align: center;
}
.vocab-card:hover { box-shadow: var(--shadow-lg); }
.vocab-card.flipped { background: var(--green-bg); border-color: rgba(34,197,94,0.3); }
.vocab-word {
  font-family: 'Fraunces', serif;
  font-size: 20px; font-weight: 700; color: var(--green2);
  margin-bottom: 4px;
}
.vocab-trans { font-size: 13px; color: var(--text2); }
.vocab-cat-title {
  font-size: 12px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.08em; color: var(--text2);
  margin: 20px 0 10px; padding-left: 4px;
}
.vocab-cat-title:first-child { margin-top: 0; }

/* â”€â”€â”€ GRAMMAR SCREEN â”€â”€â”€ */
.grammar-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 22px;
  margin-bottom: 12px; box-shadow: var(--shadow);
}
.grammar-card h3 {
  font-family: 'Fraunces', serif;
  font-size: 18px; font-weight: 700; margin-bottom: 10px;
  display: flex; align-items: center; gap: 8px;
}
.grammar-card p { font-size: 14px; color: var(--text2); line-height: 1.65; margin-bottom: 10px; }
.grammar-table {
  width: 100%; border-collapse: collapse; margin-top: 8px; font-size: 14px;
}
.grammar-table th {
  text-align: left; padding: 8px 10px;
  background: var(--bg2); font-weight: 600;
  border-radius: 6px 6px 0 0;
}
.grammar-table td {
  padding: 7px 10px; border-bottom: 1px solid var(--border);
}
.grammar-table tr:last-child td { border-bottom: none; }
.grammar-example {
  background: var(--bg2); border-radius: 10px;
  padding: 12px 14px; margin-top: 8px;
  font-size: 14px; line-height: 1.6;
}
.grammar-example .pt { color: var(--green2); font-weight: 600; }
.grammar-example .de { color: var(--text2); font-style: italic; }

/* â”€â”€â”€ SECTION TITLE â”€â”€â”€ */
.sec-title {
  font-family: 'Fraunces', serif;
  font-size: 24px; font-weight: 700; margin-bottom: 4px;
}
.sec-sub { font-size: 14px; color: var(--text2); margin-bottom: 20px; }

/* â”€â”€â”€ SLANG SCREEN â”€â”€â”€ */
.slang-item {
  background: var(--card); border: 1px solid var(--border);
  border-radius: 14px; padding: 16px 18px;
  margin-bottom: 8px; cursor: pointer;
  box-shadow: var(--shadow); transition: all 0.2s;
}
.slang-item:hover { box-shadow: var(--shadow-lg); }
.slang-item.open { border-color: var(--purple); }
.slang-phrase2 {
  font-family: 'Fraunces', serif;
  font-size: 18px; font-weight: 700; color: var(--purple);
}
.slang-mean { font-size: 13px; color: var(--text2); margin-top: 2px; }
.slang-detail {
  margin-top: 12px; padding-top: 12px;
  border-top: 1px solid var(--border);
  font-size: 13px; line-height: 1.7;
  animation: fadeUp 0.25s ease;
}
.slang-detail .tone-label {
  font-size: 11px; font-weight: 700; color: var(--purple);
  text-transform: uppercase; letter-spacing: 0.06em;
}
.slang-detail .ex {
  background: var(--purple-bg); border-radius: 10px;
  padding: 10px 12px; margin-top: 8px;
  font-style: italic;
}

/* Audio button */
.audio-btn {
  background: var(--blue-bg); border: 2px solid var(--blue);
  border-radius: 12px; padding: 12px 20px;
  cursor: pointer; font-size: 15px; font-weight: 600;
  color: var(--blue); display: flex; align-items: center; gap: 8px;
  margin-bottom: 16px; transition: all 0.15s;
}
.audio-btn:hover { background: var(--blue); color: white; }

/* Fill blank */
.fill-sentence {
  font-size: 20px; font-weight: 500; line-height: 1.6;
  margin-bottom: 20px;
}
.fill-blank {
  display: inline-block; min-width: 100px;
  border-bottom: 3px solid var(--blue);
  padding: 2px 8px; margin: 0 4px;
  font-weight: 700; color: var(--blue);
}

@media (max-width: 400px) {
  .vocab-grid { grid-template-columns: 1fr; }
  .match-grid { grid-template-columns: 1fr 1fr; gap: 6px; }
}
</style>
</head>
<body>

<div class="topbar">
  <div class="topbar-inner">
    <div class="topbar-logo">ğŸ‡§ğŸ‡· Fala!</div>
    <div class="topbar-stats">
      <div class="stat"><span class="stat-icon">âš¡</span><span class="xp" id="xp-display">0</span></div>
      <div class="stat"><span class="stat-icon">ğŸ”¥</span><span class="streak" id="streak-display">1</span></div>
      <div class="stat"><span class="stat-icon">ğŸ“Š</span><span class="level" id="level-display">A1</span></div>
    </div>
  </div>
</div>

<div class="app">
  <!-- HOME -->
  <div class="screen active" id="screen-home"></div>
  <!-- UNIT -->
  <div class="screen" id="screen-unit"></div>
  <!-- EXERCISE -->
  <div class="screen" id="screen-exercise"></div>
  <!-- VOCAB -->
  <div class="screen" id="screen-vocab"></div>
  <!-- GRAMMAR -->
  <div class="screen" id="screen-grammar"></div>
  <!-- SLANG -->
  <div class="screen" id="screen-slang"></div>
</div>

<nav class="bottomnav">
  <div class="bottomnav-inner">
    <button class="bnav-btn active" data-screen="home" onclick="goScreen('home')"><span class="ico">ğŸ“š</span>Lernen</button>
    <button class="bnav-btn" data-screen="vocab" onclick="goScreen('vocab')"><span class="ico">ğŸ”¤</span>Vokabeln</button>
    <button class="bnav-btn" data-screen="grammar" onclick="goScreen('grammar')"><span class="ico">ğŸ“</span>Grammatik</button>
    <button class="bnav-btn" data-screen="slang" onclick="goScreen('slang')"><span class="ico">ğŸ—£ï¸</span>GÃ­rias</button>
  </div>
</nav>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CURRICULUM DATA â€“ A1/A2 structured
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const CURRICULUM = [
  {
    id: 'u1', title: 'OlÃ¡! BegrÃ¼ÃŸungen', desc: 'Sich vorstellen, grÃ¼ÃŸen und verabschieden',
    color: '#22c55e', bgColor: '#dcfce7',
    lessons: [
      {
        id: 'u1l1', title: 'Hallo & TschÃ¼ss', type: 'mixed', xp: 15,
        exercises: [
          { type:'info', title:'BegrÃ¼ÃŸungen', content:'Auf Portugiesisch gibt es drei TagesgrÃ¼ÃŸe:\n\nğŸŒ… Bom dia = Guten Morgen\nâ˜€ï¸ Boa tarde = Guten Nachmittag\nğŸŒ™ Boa noite = Guten Abend / Gute Nacht\n\nğŸ‘‹ OlÃ¡ = Hallo (neutral, immer passend)\nğŸ‘‹ Oi = Hi (informell)' },
          { type:'pick', prompt:'Wie sagt man "Guten Morgen"?', options:['Boa noite','Bom dia','Boa tarde','OlÃ¡'], correct:1 },
          { type:'pick', prompt:'Was bedeutet "Boa noite"?', options:['Guten Morgen','Guten Nachmittag','Guten Abend','Hallo'], correct:2 },
          { type:'write', prompt:'Schreib "Hallo" auf Portugiesisch', answer:'olÃ¡', hint:'Beginnt mit O...' },
          { type:'pick', prompt:'"Oi" ist...', options:['Formell','Informell (wie "Hi")','Eine Verabschiedung','Ein Name'], correct:1 },
          { type:'write', prompt:'Ãœbersetze: "Guten Nachmittag"', answer:'boa tarde', hint:'Boa = gut (weiblich), Tarde = Nachmittag' },
          { type:'info', title:'Verabschiedungen', content:'ğŸ‘‹ Tchau = TschÃ¼ss\nğŸ‘‹ AtÃ© logo = Bis bald\nğŸ‘‹ AtÃ© amanhÃ£ = Bis morgen\n\nInformell:\nâœŒï¸ Falou! = TschÃ¼ss! / Abgemacht!\nâœŒï¸ Valeu! = Danke / TschÃ¼ss!' },
          { type:'pick', prompt:'Was bedeutet "AtÃ© amanhÃ£"?', options:['Bis bald','Bis morgen','Guten Tag','Danke'], correct:1 },
          { type:'write', prompt:'Schreib "TschÃ¼ss" auf Portugiesisch', answer:'tchau', hint:'Klingt wie das italienische "ciao"' },
          { type:'match', prompt:'Verbinde die Paare', pairs:[['Bom dia','Guten Morgen'],['Boa noite','Guten Abend'],['Tchau','TschÃ¼ss'],['OlÃ¡','Hallo']] },
        ]
      },
      {
        id: 'u1l2', title: 'Wie geht es dir?', type: 'mixed', xp: 15,
        exercises: [
          { type:'info', title:'Nach dem Befinden fragen', content:'ğŸ¤ Tudo bem? = Alles gut?\nğŸ¤ Como vai? = Wie geht\'s?\nğŸ¤ Como vocÃª estÃ¡? = Wie geht es dir/Ihnen?\n\nAntworten:\nâœ… Tudo bem! = Alles gut!\nâœ… Tudo bom! = Alles bestens!\nâœ… Estou bem = Mir geht\'s gut\nâŒ Mais ou menos = So lala' },
          { type:'pick', prompt:'"Tudo bem?" bedeutet...', options:['Woher kommst du?','Alles gut?','Wie heiÃŸt du?','Danke'], correct:1 },
          { type:'write', prompt:'Antworte positiv auf "Tudo bem?"', answer:'tudo bem', hint:'Gleiche Worte, aber als Aussage!' },
          { type:'pick', prompt:'Was bedeutet "Mais ou menos"?', options:['Sehr gut','Alles bestens','So lala','Schlecht'], correct:2 },
          { type:'pick', prompt:'Welche Antwort passt zu "Como vai?"', options:['Tchau','Tudo bom!','Bom dia','AtÃ© logo'], correct:1 },
          { type:'fill', sentence:'Como vocÃª ___?', blank:'estÃ¡', hint:'Das Verb "sein" fÃ¼r "du/Sie"' },
          { type:'match', prompt:'Verbinde richtig', pairs:[['Tudo bem?','Alles gut?'],['Estou bem','Mir geht\'s gut'],['Mais ou menos','So lala'],['Como vai?','Wie geht\'s?']] },
          { type:'write', prompt:'Ãœbersetze: "Mir geht es gut"', answer:'estou bem', hint:'Estou = Ich bin (temporÃ¤r)' },
        ]
      },
      {
        id: 'u1l3', title: 'Sich vorstellen', type: 'mixed', xp: 20,
        exercises: [
          { type:'info', title:'Name & Herkunft', content:'ğŸ‘¤ Meu nome Ã©... = Mein Name ist...\nğŸ‘¤ Eu sou... = Ich bin...\nğŸ‘¤ Me chamo... = Ich heiÃŸe...\n\nğŸŒ Eu sou da Alemanha = Ich bin aus Deutschland\nğŸŒ Eu sou de Berlim = Ich bin aus Berlin\n\nğŸ“ Wichtig:\nâ€¢ "da" = de + a (fÃ¼r weibliche LÃ¤nder)\nâ€¢ "do" = de + o (fÃ¼r mÃ¤nnliche LÃ¤nder)\nâ€¢ Die meisten LÃ¤nder sind weiblich!' },
          { type:'pick', prompt:'"Eu sou da Alemanha" bedeutet...', options:['Ich liebe Deutschland','Ich bin aus Deutschland','Ich fahre nach Deutschland','Ich kenne Deutschland'], correct:1 },
          { type:'write', prompt:'Schreib: "Mein Name ist" auf Portugiesisch', answer:'meu nome Ã©', hint:'Meu = Mein, Nome = Name, Ã‰ = ist' },
          { type:'fill', sentence:'Eu ___ de Berlim.', blank:'sou', hint:'Das Verb "sein" fÃ¼r "ich"' },
          { type:'pick', prompt:'Wie fragst du "Wie heiÃŸt du?"', options:['Qual Ã© seu nome?','Tudo bem?','De onde vocÃª Ã©?','Quanto custa?'], correct:0 },
          { type:'write', prompt:'Ãœbersetze: "Ich bin aus Deutschland"', answer:'eu sou da alemanha', hint:'Eu sou + da + Alemanha' },
          { type:'info', title:'Freut mich!', content:'ğŸ¤ Muito prazer! = Freut mich sehr!\nğŸ¤ Prazer em te conhecer! = Freut mich dich kennenzulernen!\n\nInformell: "E aÃ­? Beleza?" = Hey, alles klar?' },
          { type:'pick', prompt:'"Muito prazer" sagt man...', options:['Beim Essen','Beim Kennenlernen','Beim Abschied','Beim Telefonieren'], correct:1 },
          { type:'match', prompt:'Verbinde die Paare', pairs:[['Meu nome Ã©','Mein Name ist'],['Eu sou de','Ich bin aus'],['Muito prazer','Freut mich'],['Qual Ã© seu nome?','Wie heiÃŸt du?']] },
          { type:'write', prompt:'Ãœbersetze: "Freut mich!"', answer:'muito prazer', hint:'Muito = Sehr, Prazer = Freude/VergnÃ¼gen' },
        ]
      },
    ]
  },
  {
    id: 'u2', title: 'NÃºmeros & Cores', desc: 'Zahlen von 0-20, Farben und einfaches ZÃ¤hlen',
    color: '#3b82f6', bgColor: '#dbeafe',
    lessons: [
      {
        id: 'u2l1', title: 'Zahlen 0-10', type: 'mixed', xp: 15,
        exercises: [
          { type:'info', title:'Zahlen 0 bis 10', content:'0 = zero\n1 = um / uma\n2 = dois / duas\n3 = trÃªs\n4 = quatro\n5 = cinco\n6 = seis\n7 = sete\n8 = oito\n9 = nove\n10 = dez\n\nğŸ“ Achtung: 1 und 2 haben mÃ¤nnliche UND weibliche Formen!\nâ€¢ um cafÃ© (ein Kaffee) / uma Ã¡gua (ein Wasser)\nâ€¢ dois cafÃ©s / duas Ã¡guas' },
          { type:'pick', prompt:'Was ist "cinco"?', options:['3','4','5','6'], correct:2 },
          { type:'write', prompt:'Schreib die Zahl 7 auf Portugiesisch', answer:'sete', hint:'S-E-T-E' },
          { type:'pick', prompt:'"Oito" ist welche Zahl?', options:['6','7','8','9'], correct:2 },
          { type:'match', prompt:'Verbinde Zahlen', pairs:[['trÃªs','3'],['seis','6'],['nove','9'],['dez','10']] },
          { type:'write', prompt:'Schreib die Zahl 4 auf Portugiesisch', answer:'quatro', hint:'Wie "Quartett" â€“ vier!' },
          { type:'fill', sentence:'___ cafÃ©s, por favor.', blank:'dois', hint:'Zwei Kaffee bitte (mÃ¤nnlich!)' },
        ]
      },
      {
        id: 'u2l2', title: 'Zahlen 11-20 & Farben', type: 'mixed', xp: 20,
        exercises: [
          { type:'info', title:'Zahlen 11-20', content:'11 = onze\n12 = doze\n13 = treze\n14 = catorze / quatorze\n15 = quinze\n16 = dezesseis\n17 = dezessete\n18 = dezoito\n19 = dezenove\n20 = vinte' },
          { type:'pick', prompt:'Was ist "quinze"?', options:['14','15','16','17'], correct:1 },
          { type:'write', prompt:'Schreib 20 auf Portugiesisch', answer:'vinte', hint:'V-I-N-T-E' },
          { type:'info', title:'Farben (Cores)', content:'ğŸ”´ Vermelho = Rot\nğŸ”µ Azul = Blau\nğŸŸ¢ Verde = GrÃ¼n\nğŸŸ¡ Amarelo = Gelb\nâš« Preto = Schwarz\nâšª Branco = WeiÃŸ\nğŸŸ  Laranja = Orange\nğŸ©· Rosa = Rosa/Pink' },
          { type:'pick', prompt:'"Verde" bedeutet...', options:['Rot','Gelb','GrÃ¼n','Blau'], correct:2 },
          { type:'match', prompt:'Verbinde die Farben', pairs:[['Vermelho','Rot'],['Azul','Blau'],['Amarelo','Gelb'],['Preto','Schwarz']] },
          { type:'write', prompt:'Schreib "WeiÃŸ" auf Portugiesisch', answer:'branco', hint:'B-R-A-N-C-O' },
          { type:'fill', sentence:'O cÃ©u Ã© ___.', blank:'azul', hint:'Der Himmel ist ... (blau)' },
        ]
      },
    ]
  },
  {
    id: 'u3', title: 'No CafÃ©', desc: 'Im CafÃ© bestellen, Essen & Trinken, HÃ¶flichkeitsformen',
    color: '#f59e0b', bgColor: '#fef3c7',
    lessons: [
      {
        id: 'u3l1', title: 'Bestellen im CafÃ©', type: 'mixed', xp: 20,
        exercises: [
          { type:'info', title:'Im CafÃ© bestellen', content:'â˜• Um cafÃ©, por favor = Einen Kaffee, bitte\nğŸ¥ Um pÃ£o de queijo = Ein KÃ¤sebrÃ¶tchen\nğŸ¥¤ Um suco de laranja = Einen Orangensaft\nğŸ’§ Uma Ã¡gua = Ein Wasser\nğŸº Uma cerveja = Ein Bier\n\nğŸ’° Quanto custa? = Wie viel kostet das?\nğŸ’° A conta, por favor = Die Rechnung, bitte\n\nğŸ“ "Um" (mÃ¤nnlich) vs "Uma" (weiblich):\nâ€¢ Um cafÃ©, um suco, um pÃ£o\nâ€¢ Uma Ã¡gua, uma cerveja, uma conta' },
          { type:'pick', prompt:'Wie bestellst du einen Kaffee?', options:['Uma cafÃ©','Um cafÃ©, por favor','CafÃ© aqui','Quero cafÃ© agora'], correct:1 },
          { type:'write', prompt:'Ãœbersetze: "Die Rechnung, bitte"', answer:'a conta por favor', hint:'A conta = die Rechnung' },
          { type:'fill', sentence:'___ Ã¡gua, por favor.', blank:'uma', hint:'Ãgua ist weiblich!' },
          { type:'pick', prompt:'"Quanto custa?" bedeutet...', options:['Was ist das?','Wo ist das?','Wie viel kostet das?','Haben Sie das?'], correct:2 },
          { type:'match', prompt:'Verbinde', pairs:[['cafÃ©','Kaffee'],['Ã¡gua','Wasser'],['cerveja','Bier'],['suco','Saft']] },
          { type:'write', prompt:'Bestelle ein Bier auf Portugiesisch', answer:'uma cerveja por favor', hint:'Cerveja ist weiblich â†’ Uma' },
          { type:'fill', sentence:'Quanto ___?', blank:'custa', hint:'Wie viel ... es? (kosten)' },
        ]
      },
      {
        id: 'u3l2', title: 'Essen & Geschmack', type: 'mixed', xp: 20,
        exercises: [
          { type:'info', title:'Essen beschreiben', content:'ğŸ˜‹ Delicioso! = Lecker!\nğŸ˜‹ Gostoso! = Lecker! (informeller)\nğŸŒ¶ï¸ Picante = Scharf\nğŸ§‚ Salgado = Salzig\nğŸ¬ Doce = SÃ¼ÃŸ\nğŸ˜• Ruim = Schlecht\n\nNÃ¼tzliche SÃ¤tze:\nâ€¢ Eu quero... = Ich mÃ¶chte...\nâ€¢ Eu nÃ£o quero... = Ich mÃ¶chte nicht...\nâ€¢ Tem...? = Haben Sie...? / Gibt es...?' },
          { type:'pick', prompt:'"Gostoso" bedeutet...', options:['Salzig','SÃ¼ÃŸ','Lecker','Scharf'], correct:2 },
          { type:'write', prompt:'Wie sagst du "Ich mÃ¶chte..."?', answer:'eu quero', hint:'Eu = Ich, Quero = mÃ¶chte/will' },
          { type:'fill', sentence:'Eu ___ um cafÃ©.', blank:'quero', hint:'Ich ... einen Kaffee (wollen)' },
          { type:'pick', prompt:'"Tem cerveja?" bedeutet...', options:['Ist das Bier?','Haben Sie Bier?','Wo ist Bier?','Kein Bier!'], correct:1 },
          { type:'match', prompt:'Verbinde', pairs:[['doce','sÃ¼ÃŸ'],['salgado','salzig'],['picante','scharf'],['delicioso','lecker']] },
          { type:'write', prompt:'Ãœbersetze: "Ich mÃ¶chte nicht"', answer:'eu nÃ£o quero', hint:'NÃ£o = nicht (vor dem Verb!)' },
        ]
      },
    ]
  },
  {
    id: 'u4', title: 'Eu, VocÃª, NÃ³s', desc: 'Personalpronomen, Verb "sein" (ser/estar), einfache SÃ¤tze',
    color: '#8b5cf6', bgColor: '#ede9fe',
    lessons: [
      {
        id: 'u4l1', title: 'Pronomen & Ser', type: 'mixed', xp: 25,
        exercises: [
          { type:'info', title:'Personalpronomen', content:'ğŸ‘¤ Eu = Ich\nğŸ‘¤ VocÃª = Du / Sie\nğŸ‘¤ Ele = Er\nğŸ‘¤ Ela = Sie (weiblich)\nğŸ‘¥ NÃ³s = Wir\nğŸ‘¥ VocÃªs = Ihr / Sie (Plural)\nğŸ‘¥ Eles = Sie (mÃ¤nnl. Plural)\nğŸ‘¥ Elas = Sie (weibl. Plural)\n\nğŸ“ In Brasilien benutzt man fast immer "vocÃª" statt "tu"!' },
          { type:'pick', prompt:'"NÃ³s" bedeutet...', options:['Ich','Du','Wir','Sie'], correct:2 },
          { type:'info', title:'Das Verb SER (sein â€“ permanent)', content:'SER = sein (dauerhaft, IdentitÃ¤t)\n\nEu sou = Ich bin\nVocÃª Ã© = Du bist\nEle/Ela Ã© = Er/Sie ist\nNÃ³s somos = Wir sind\nVocÃªs sÃ£o = Ihr seid\nEles/Elas sÃ£o = Sie sind\n\nBeispiele:\nâ€¢ Eu sou alemÃ£o = Ich bin Deutscher\nâ€¢ Ela Ã© brasileira = Sie ist Brasilianerin\nâ€¢ NÃ³s somos amigos = Wir sind Freunde' },
          { type:'fill', sentence:'Eu ___ brasileiro.', blank:'sou', hint:'"Ich bin" mit ser' },
          { type:'pick', prompt:'"Ela Ã© professora" bedeutet...', options:['Er ist Lehrer','Sie ist Lehrerin','Wir sind Lehrer','Sie sind Lehrer'], correct:1 },
          { type:'write', prompt:'Ãœbersetze: "Wir sind Freunde"', answer:'nÃ³s somos amigos', hint:'NÃ³s + somos + amigos' },
          { type:'fill', sentence:'VocÃªs ___ de onde?', blank:'sÃ£o', hint:'"Ihr seid" / "Sie sind" mit ser' },
          { type:'match', prompt:'Konjugiere SER', pairs:[['Eu','sou'],['VocÃª','Ã©'],['NÃ³s','somos'],['Eles','sÃ£o']] },
          { type:'write', prompt:'Ãœbersetze: "Er ist Brasilianer"', answer:'ele Ã© brasileiro', hint:'Ele + Ã© + brasileiro' },
        ]
      },
      {
        id: 'u4l2', title: 'Ser vs. Estar', type: 'mixed', xp: 25,
        exercises: [
          { type:'info', title:'SER vs ESTAR â€“ der groÃŸe Unterschied!', content:'ğŸ”µ SER = sein (DAUERHAFT)\nâ†’ IdentitÃ¤t, Herkunft, Beruf, Charakter\nâ€¢ Eu sou alemÃ£o (Ich bin Deutscher)\nâ€¢ Ela Ã© bonita (Sie ist schÃ¶n â€“ immer)\n\nğŸŸ¢ ESTAR = sein (TEMPORÃ„R)\nâ†’ GefÃ¼hle, ZustÃ¤nde, Orte\nâ€¢ Eu estou feliz (Ich bin gerade glÃ¼cklich)\nâ€¢ Ele estÃ¡ em casa (Er ist zu Hause)\n\nESTAR konjugiert:\nEu estou / VocÃª estÃ¡ / NÃ³s estamos\n\nğŸ“ EselsbrÃ¼cke: Wenn es sich Ã¤ndern kann â†’ ESTAR!' },
          { type:'pick', prompt:'"Eu estou cansado" â€“ warum ESTAR?', options:['Weil ich immer mÃ¼de bin','Weil mÃ¼de sein temporÃ¤r ist','Weil es eine Frage ist','Weil ich ein Mann bin'], correct:1 },
          { type:'pick', prompt:'Welcher Satz ist richtig?', options:['Eu sou feliz (gerade)','Eu estou brasileiro','Eu estou em casa','Eu sou cansado (gerade)'], correct:2 },
          { type:'fill', sentence:'Ela ___ bonita. (immer)', blank:'Ã©', hint:'Dauerhaft schÃ¶n = SER' },
          { type:'fill', sentence:'Eu ___ cansado. (gerade)', blank:'estou', hint:'Gerade mÃ¼de = ESTAR' },
          { type:'pick', prompt:'"NÃ³s estamos no Brasil" â€“ richtig oder falsch?', options:['Richtig â€“ wir sind gerade dort','Falsch â€“ mÃ¼sste "somos" sein'], correct:0 },
          { type:'match', prompt:'SER oder ESTAR?', pairs:[['Eu ___ alemÃ£o','sou (SER)'],['Eu ___ feliz (gerade)','estou (ESTAR)'],['Ela ___ professora','Ã© (SER)'],['Ele ___ em casa','estÃ¡ (ESTAR)']] },
          { type:'write', prompt:'Ãœbersetze: "Ich bin mÃ¼de" (gerade)', answer:'eu estou cansado', hint:'TemporÃ¤r â†’ ESTAR: estou' },
        ]
      },
    ]
  },
  {
    id: 'u5', title: 'Dia a Dia', desc: 'Alltag, Uhrzeit, Wochentage, tÃ¤gliche Routinen',
    color: '#14b8a6', bgColor: '#ccfbf1',
    lessons: [
      {
        id: 'u5l1', title: 'Wochentage & Uhrzeit', type: 'mixed', xp: 20,
        exercises: [
          { type:'info', title:'Wochentage', content:'ğŸ“… Segunda-feira = Montag\nğŸ“… TerÃ§a-feira = Dienstag\nğŸ“… Quarta-feira = Mittwoch\nğŸ“… Quinta-feira = Donnerstag\nğŸ“… Sexta-feira = Freitag\nğŸ“… SÃ¡bado = Samstag\nğŸ“… Domingo = Sonntag\n\nğŸ“ Im Alltag lÃ¤sst man "-feira" oft weg:\n"Na segunda" = Am Montag' },
          { type:'pick', prompt:'Welcher Tag ist "Quarta-feira"?', options:['Montag','Dienstag','Mittwoch','Donnerstag'], correct:2 },
          { type:'match', prompt:'Verbinde die Tage', pairs:[['Segunda','Montag'],['Sexta','Freitag'],['SÃ¡bado','Samstag'],['Domingo','Sonntag']] },
          { type:'info', title:'Uhrzeit', content:'ğŸ• Que horas sÃ£o? = Wie spÃ¤t ist es?\n\nâ€¢ Ã‰ uma hora = Es ist 1 Uhr\nâ€¢ SÃ£o duas horas = Es ist 2 Uhr\nâ€¢ SÃ£o trÃªs e meia = Es ist halb 4 (3:30)\nâ€¢ SÃ£o cinco e quinze = Es ist Viertel nach 5\n\nğŸ“ 1 Uhr: "Ã‰" (Singular)\nAb 2 Uhr: "SÃ£o" (Plural)' },
          { type:'pick', prompt:'"SÃ£o trÃªs e meia" bedeutet...', options:['3:15','3:30','3:45','3:00'], correct:1 },
          { type:'fill', sentence:'Que horas ___?', blank:'sÃ£o', hint:'Wie spÃ¤t ... es?' },
          { type:'write', prompt:'Schreib: "Wie spÃ¤t ist es?"', answer:'que horas sÃ£o', hint:'Que = Was/Welche, Horas = Stunden' },
        ]
      },
    ]
  },
];

const VOCAB_DATA = {
  'BegrÃ¼ÃŸungen': [
    {pt:'OlÃ¡',de:'Hallo'},{pt:'Oi',de:'Hi'},{pt:'Bom dia',de:'Guten Morgen'},
    {pt:'Boa tarde',de:'Guten Nachmittag'},{pt:'Boa noite',de:'Guten Abend'},
    {pt:'Tchau',de:'TschÃ¼ss'},{pt:'AtÃ© logo',de:'Bis bald'},{pt:'AtÃ© amanhÃ£',de:'Bis morgen'},
  ],
  'Grundlagen': [
    {pt:'Sim',de:'Ja'},{pt:'NÃ£o',de:'Nein'},{pt:'Por favor',de:'Bitte'},
    {pt:'Obrigado/a',de:'Danke'},{pt:'Desculpa',de:'Entschuldigung'},
    {pt:'Tudo bem?',de:'Alles gut?'},{pt:'Muito prazer',de:'Freut mich'},
  ],
  'Essen & Trinken': [
    {pt:'CafÃ©',de:'Kaffee'},{pt:'Ãgua',de:'Wasser'},{pt:'Cerveja',de:'Bier'},
    {pt:'Suco',de:'Saft'},{pt:'PÃ£o',de:'Brot'},{pt:'Comida',de:'Essen'},
    {pt:'Comer',de:'Essen (Verb)'},{pt:'Beber',de:'Trinken'},
  ],
  'Farben': [
    {pt:'Vermelho',de:'Rot'},{pt:'Azul',de:'Blau'},{pt:'Verde',de:'GrÃ¼n'},
    {pt:'Amarelo',de:'Gelb'},{pt:'Preto',de:'Schwarz'},{pt:'Branco',de:'WeiÃŸ'},
  ],
  'Pronomen': [
    {pt:'Eu',de:'Ich'},{pt:'VocÃª',de:'Du'},{pt:'Ele',de:'Er'},
    {pt:'Ela',de:'Sie'},{pt:'NÃ³s',de:'Wir'},{pt:'Eles/Elas',de:'Sie (Plural)'},
  ],
  'Adjektive': [
    {pt:'Bom / Boa',de:'Gut'},{pt:'Bonito/a',de:'SchÃ¶n'},{pt:'Grande',de:'GroÃŸ'},
    {pt:'Pequeno/a',de:'Klein'},{pt:'Quente',de:'HeiÃŸ'},{pt:'Frio',de:'Kalt'},
    {pt:'Feliz',de:'GlÃ¼cklich'},{pt:'Cansado/a',de:'MÃ¼de'},
  ],
};

const GRAMMAR_DATA = [
  {
    title:'ğŸ“ Artikel: O / A / Um / Uma', content:'Portugiesisch hat bestimmte und unbestimmte Artikel mit Genus.\n\nBestimmte Artikel:\nâ€¢ O (der) â†’ o cafÃ©, o carro\nâ€¢ A (die) â†’ a casa, a Ã¡gua\n\nUnbestimmte Artikel:\nâ€¢ Um (ein) â†’ um cafÃ©\nâ€¢ Uma (eine) â†’ uma Ã¡gua\n\nPlural: Os / As',
    table:[['','MÃ¤nnlich','Weiblich'],['Bestimmt','o','a'],['Unbestimmt','um','uma'],['Plural best.','os','as']],
    examples:[{pt:'O cafÃ© Ã© bom.',de:'Der Kaffee ist gut.'},{pt:'Uma cerveja, por favor.',de:'Ein Bier, bitte.'}]
  },
  {
    title:'ğŸ”„ SER vs ESTAR (sein)', content:'Beide bedeuten "sein", aber werden unterschiedlich verwendet.\n\nSER â†’ dauerhaft (IdentitÃ¤t, Herkunft, Beruf)\nESTAR â†’ temporÃ¤r (GefÃ¼hle, Orte, ZustÃ¤nde)',
    table:[['Pronomen','SER','ESTAR'],['Eu','sou','estou'],['VocÃª','Ã©','estÃ¡'],['Ele/Ela','Ã©','estÃ¡'],['NÃ³s','somos','estamos'],['Eles','sÃ£o','estÃ£o']],
    examples:[{pt:'Eu sou alemÃ£o.',de:'Ich bin Deutscher. (immer)'},{pt:'Eu estou cansado.',de:'Ich bin mÃ¼de. (gerade)'}]
  },
  {
    title:'ğŸš« Verneinung mit NÃƒO', content:'Die Verneinung ist einfach: "nÃ£o" kommt VOR das Verb.\n\nDas ist viel einfacher als im Deutschen!',
    table:null,
    examples:[{pt:'Eu nÃ£o falo portuguÃªs.',de:'Ich spreche nicht Portugiesisch.'},{pt:'Ela nÃ£o Ã© brasileira.',de:'Sie ist nicht Brasilianerin.'},{pt:'NÃ³s nÃ£o estamos em casa.',de:'Wir sind nicht zu Hause.'}]
  },
  {
    title:'â“ Fragen stellen', content:'Gute Nachricht: Die Satzstellung Ã¤ndert sich bei Fragen NICHT!\nMan hebt einfach die Stimme am Ende.\n\nFragewÃ¶rter:\nâ€¢ Quem? = Wer?\nâ€¢ O que? = Was?\nâ€¢ Onde? = Wo?\nâ€¢ Quando? = Wann?\nâ€¢ Por que? = Warum?\nâ€¢ Como? = Wie?\nâ€¢ Quanto? = Wie viel?',
    table:null,
    examples:[{pt:'VocÃª Ã© brasileiro?',de:'Bist du Brasilianer? (gleiche Satzstellung!)'},{pt:'Onde vocÃª mora?',de:'Wo wohnst du?'},{pt:'Quanto custa?',de:'Wie viel kostet das?'}]
  },
  {
    title:'ğŸ‘« Genus: MÃ¤nnlich & Weiblich', content:'Die meisten Substantive und Adjektive haben ein Genus.\n\nFaustregel:\nâ€¢ Endet auf -O â†’ meistens mÃ¤nnlich\nâ€¢ Endet auf -A â†’ meistens weiblich\n\nAdjektive passen sich an:\nâ€¢ Ele Ã© bonito / Ela Ã© bonita\nâ€¢ O carro Ã© preto / A casa Ã© preta',
    table:null,
    examples:[{pt:'O menino Ã© alto.',de:'Der Junge ist groÃŸ.'},{pt:'A menina Ã© alta.',de:'Das MÃ¤dchen ist groÃŸ.'}]
  },
];

const SLANG_DATA = [
  {phrase:"E aÃ­?",meaning:"Was geht?",tone:"Super lÃ¤ssig, unter Freunden",example:"E aÃ­, mano? Tudo bem?"},
  {phrase:"Beleza!",meaning:"Alles klar! / Cool!",tone:"Zustimmend, entspannt",example:"Vamos Ã s 8? â€“ Beleza!"},
  {phrase:"Cara / Mano",meaning:"Alter / Kumpel",tone:"Wie 'Dude'",example:"Cara, tu nÃ£o vai acreditar!"},
  {phrase:"TÃ¡ ligado?",meaning:"WeiÃŸt du? / Verstehst du?",tone:"Jugendlich, StraÃŸe",example:"Ele Ã© gente boa, tÃ¡ ligado?"},
  {phrase:"Valeu!",meaning:"Danke! / TschÃ¼ss!",tone:"Informell",example:"Valeu, mano! Falou!"},
  {phrase:"Que massa!",meaning:"Wie geil! / Wie cool!",tone:"Begeistert",example:"Ganhei um carro novo! â€“ Que massa!"},
  {phrase:"TÃ´ nem aÃ­",meaning:"Juckt mich nicht",tone:"GleichgÃ¼ltig",example:"TÃ´ nem aÃ­ pro que ele fala."},
  {phrase:"PÃ´!",meaning:"Mensch! / Ach Mann!",tone:"Frustriert / Ãœberrascht",example:"PÃ´, esqueci a carteira!"},
  {phrase:"Saudade",meaning:"Sehnsucht (unÃ¼bersetzbar!)",tone:"Emotional, tief",example:"TÃ´ com saudade de vocÃª."},
  {phrase:"Gata / Gato",meaning:"HÃ¼bsche / HeiÃŸer Typ",tone:"Flirty",example:"Olha aquela gata!"},
  {phrase:"Falou!",meaning:"Abgemacht! / TschÃ¼ss!",tone:"LÃ¤ssig",example:"AmanhÃ£ Ã s 10, falou!"},
  {phrase:"Caramba!",meaning:"Wow! / Verdammt!",tone:"Ãœberrascht",example:"Caramba, que jogo!"},
  {phrase:"Pode crer!",meaning:"Stimmt! / Ja voll!",tone:"BestÃ¤tigend",example:"Essa pizza Ã© a melhor. â€“ Pode crer!"},
  {phrase:"TÃ´ de boa",meaning:"Ich chill / Mir geht's gut",tone:"Relaxed",example:"Quer sair? â€“ Nah, tÃ´ de boa."},
  {phrase:"MermÃ£o",meaning:"Bruder (meu irmÃ£o)",tone:"Rio-Slang",example:"MermÃ£o, para com isso!"},
  {phrase:"Suave",meaning:"Easy / Kein Problem",tone:"Gelassen",example:"Deu pra fazer? â€“ Suave!"},
  {phrase:"Partiu!",meaning:"Los geht's!",tone:"Aufbruch",example:"Partiu praia!"},
  {phrase:"Vacilou",meaning:"Fail / Mist gebaut",tone:"Spielerisch vorwurfsvoll",example:"Vacilou, hein!"},
  {phrase:"Bora!",meaning:"Komm! Los!",tone:"Energisch",example:"Bora almoÃ§ar?"},
  {phrase:"Zoar",meaning:"Verarschen / Rumalbern",tone:"Unter Kumpels",example:"Para de me zoar!"},
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let state = {
  xp: 0, streak: 1, screen: 'home',
  completedLessons: {},
  currentUnit: null,
  currentLesson: null,
  exerciseIdx: 0,
  hearts: 3,
  lessonXP: 0,
  selected: null,
  answered: false,
  matchState: null,
  bankWords: null,
  flippedVocab: {},
  openSlang: -1,
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function goScreen(name) {
  state.screen = name;
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-' + name).classList.add('active');
  document.querySelectorAll('.bnav-btn').forEach(b => {
    b.classList.toggle('active', b.dataset.screen === name);
  });
  render();
}

function updateStats() {
  document.getElementById('xp-display').textContent = state.xp;
  document.getElementById('streak-display').textContent = state.streak;
  const totalLessons = CURRICULUM.reduce((s, u) => s + u.lessons.length, 0);
  const done = Object.keys(state.completedLessons).length;
  document.getElementById('level-display').textContent = done >= totalLessons * 0.6 ? 'A2' : 'A1';
}

function render() {
  updateStats();
  if (state.screen === 'home') renderHome();
  else if (state.screen === 'unit') renderUnit();
  else if (state.screen === 'exercise') renderExercise();
  else if (state.screen === 'vocab') renderVocab();
  else if (state.screen === 'grammar') renderGrammar();
  else if (state.screen === 'slang') renderSlangScreen();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HOME â€“ Unit Map
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderHome() {
  const c = document.getElementById('screen-home');
  let prevDone = true;
  c.innerHTML = `
    <div style="margin:20px 0 24px;">
      <h2 class="sec-title">Dein Lernpfad</h2>
      <p class="sec-sub">A1 â†’ A2 Schritt fÃ¼r Schritt</p>
    </div>
    ${CURRICULUM.map((u, ui) => {
      const lessons = u.lessons;
      const done = lessons.filter(l => state.completedLessons[l.id]).length;
      const pct = Math.round((done / lessons.length) * 100);
      const locked = !prevDone && ui > 0;
      if (done === lessons.length) prevDone = true;
      else if (ui > 0) {
        const prevUnit = CURRICULUM[ui - 1];
        prevDone = prevUnit.lessons.every(l => state.completedLessons[l.id]);
      }
      const isLocked = ui > 0 && !CURRICULUM[ui - 1].lessons.every(l => state.completedLessons[l.id]);
      return `
        <div class="unit ${isLocked ? 'locked' : ''}" onclick="${isLocked ? '' : `openUnit('${u.id}')`}">
          <div class="unit-top">
            <span class="unit-num" style="background:${u.bgColor};color:${u.color};">Einheit ${ui + 1}</span>
            ${isLocked ? '<span class="unit-lock">ğŸ”’</span>' : done === lessons.length ? '<span class="unit-lock">âœ…</span>' : ''}
          </div>
          <h3>${u.title}</h3>
          <p>${u.desc}</p>
          <div class="unit-progress">
            <div class="unit-bar"><div class="unit-bar-fill" style="width:${pct}%;background:${u.color};"></div></div>
            <div class="unit-label"><span>${done}/${lessons.length} Lektionen</span><span>${pct}%</span></div>
          </div>
        </div>
      `;
    }).join('')}
  `;
}

function openUnit(uid) {
  state.currentUnit = uid;
  state.screen = 'unit';
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-unit').classList.add('active');
  render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UNIT â€“ Lesson List
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderUnit() {
  const unit = CURRICULUM.find(u => u.id === state.currentUnit);
  if (!unit) return;
  const c = document.getElementById('screen-unit');
  c.innerHTML = `
    <button class="back-btn" onclick="goScreen('home')">â† ZurÃ¼ck</button>
    <div style="margin-bottom:20px;">
      <span class="unit-num" style="background:${unit.bgColor};color:${unit.color};display:inline-block;margin-bottom:8px;">Einheit</span>
      <h2 class="sec-title">${unit.title}</h2>
      <p class="sec-sub">${unit.desc}</p>
    </div>
    <div class="lesson-list">
      ${unit.lessons.map((l, li) => {
        const done = state.completedLessons[l.id];
        const prevDone = li === 0 || state.completedLessons[unit.lessons[li - 1].id];
        const locked = !prevDone && li > 0;
        const iconBg = done ? unit.bgColor : locked ? '#f5f5f5' : unit.bgColor;
        const icons = { mixed: 'ğŸ“', vocab: 'ğŸ”¤', grammar: 'ğŸ“' };
        return `
          <div class="lesson-item ${done ? 'done' : ''} ${locked ? 'locked' : ''}"
               onclick="${locked ? '' : `startLesson('${unit.id}','${l.id}')`}">
            <div class="lesson-icon" style="background:${iconBg};">${locked ? 'ğŸ”’' : icons[l.type] || 'ğŸ“'}</div>
            <div class="lesson-info">
              <h4>${l.title}</h4>
              <p>${l.xp} XP Â· ${l.exercises.length} Ãœbungen</p>
            </div>
            ${done ? '<span class="lesson-check">âœ“</span>' : ''}
          </div>
        `;
      }).join('')}
    </div>
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// START LESSON
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startLesson(uid, lid) {
  state.currentUnit = uid;
  state.currentLesson = lid;
  state.exerciseIdx = 0;
  state.hearts = 3;
  state.lessonXP = 0;
  state.selected = null;
  state.answered = false;
  state.matchState = null;
  state.bankWords = null;
  state.screen = 'exercise';
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-exercise').classList.add('active');
  render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXERCISE RENDERER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getLesson() {
  const unit = CURRICULUM.find(u => u.id === state.currentUnit);
  return unit ? unit.lessons.find(l => l.id === state.currentLesson) : null;
}

function renderExercise() {
  const lesson = getLesson();
  if (!lesson) return;
  const exercises = lesson.exercises;
  const ex = exercises[state.exerciseIdx];
  if (!ex) { showComplete(); return; }
  const c = document.getElementById('screen-exercise');
  const pct = ((state.exerciseIdx) / exercises.length) * 100;
  const hearts = 'â¤ï¸'.repeat(state.hearts) + 'ğŸ–¤'.repeat(3 - state.hearts);

  let body = '';
  if (ex.type === 'info') body = renderInfoExercise(ex);
  else if (ex.type === 'pick') body = renderPickExercise(ex);
  else if (ex.type === 'write') body = renderWriteExercise(ex);
  else if (ex.type === 'match') body = renderMatchExercise(ex);
  else if (ex.type === 'fill') body = renderFillExercise(ex);

  c.innerHTML = `
    <div style="padding-top:12px;">
      <div class="exercise-bar">
        <button class="exercise-close" onclick="exitLesson()">âœ•</button>
        <div class="exercise-progress"><div class="exercise-progress-fill" style="width:${pct}%"></div></div>
        <div class="exercise-hearts">${hearts}</div>
      </div>
      <div class="exercise-card">${body}</div>
    </div>
  `;
}

function renderInfoExercise(ex) {
  return `
    <div class="exercise-type" style="color:var(--blue);">ğŸ“– Lektion</div>
    <h3 class="exercise-prompt">${ex.title}</h3>
    <div style="font-size:15px;line-height:1.8;white-space:pre-line;color:var(--text);margin-bottom:24px;background:var(--bg2);padding:18px;border-radius:14px;">${ex.content}</div>
    <button class="check-btn primary" onclick="nextExercise()">Weiter â†’</button>
  `;
}

function renderPickExercise(ex) {
  let fb = '';
  if (state.answered) {
    const isCorrect = state.selected === ex.correct;
    fb = `<div class="feedback ${isCorrect ? 'correct' : 'wrong'}">
      <span class="fb-icon">${isCorrect ? 'âœ…' : 'âŒ'}</span>
      <div class="fb-text"><strong>${isCorrect ? 'Richtig!' : 'Falsch!'}</strong>${!isCorrect ? 'Richtige Antwort: ' + ex.options[ex.correct] : ''}</div>
    </div>`;
  }
  return `
    <div class="exercise-type" style="color:var(--green2);">WÃ¤hle die richtige Antwort</div>
    <h3 class="exercise-prompt">${ex.prompt}</h3>
    <div class="options">
      ${ex.options.map((opt, oi) => {
        let cls = 'option-btn';
        if (state.answered) {
          cls += ' disabled';
          if (oi === ex.correct) cls += ' correct';
          else if (oi === state.selected && oi !== ex.correct) cls += ' wrong';
        } else if (state.selected === oi) cls += ' selected';
        return `<button class="${cls}" onclick="pickOption(${oi})">
          <span class="option-letter">${String.fromCharCode(65 + oi)}</span>${opt}
        </button>`;
      }).join('')}
    </div>
    ${fb}
    ${state.answered ? `<button class="check-btn next" onclick="nextExercise()">Weiter â†’</button>` :
      state.selected !== null ? `<button class="check-btn primary" onclick="checkPick()">PrÃ¼fen</button>` :
      `<button class="check-btn primary" disabled>WÃ¤hle eine Antwort</button>`}
  `;
}

function renderWriteExercise(ex) {
  let fb = '';
  if (state.answered) {
    const input = document.querySelector('.text-input');
    const val = (state._lastWriteVal || '').toLowerCase().trim();
    const isCorrect = val === ex.answer.toLowerCase();
    fb = `<div class="feedback ${isCorrect ? 'correct' : 'wrong'}">
      <span class="fb-icon">${isCorrect ? 'âœ…' : 'âŒ'}</span>
      <div class="fb-text"><strong>${isCorrect ? 'Richtig!' : 'Falsch!'}</strong>${!isCorrect ? 'Richtige Antwort: <strong>' + ex.answer + '</strong>' : ''}</div>
    </div>`;
  }
  return `
    <div class="exercise-type" style="color:var(--amber);">âœï¸ Schreib die Antwort</div>
    <h3 class="exercise-prompt">${ex.prompt}</h3>
    ${ex.hint ? `<p class="exercise-hint">ğŸ’¡ ${ex.hint}</p>` : ''}
    <div class="text-input-wrap">
      <input class="text-input ${state.answered ? (state._lastWriteCorrect ? 'correct' : 'wrong') : ''}"
             id="write-input" placeholder="Schreib hier..."
             ${state.answered ? 'disabled' : ''}
             onkeydown="if(event.key==='Enter')checkWrite()"
             value="${state.answered ? (state._lastWriteVal || '') : ''}">
    </div>
    ${fb}
    ${state.answered ? `<button class="check-btn next" onclick="nextExercise()">Weiter â†’</button>` :
      `<button class="check-btn primary" onclick="checkWrite()">PrÃ¼fen</button>`}
  `;
}

function renderFillExercise(ex) {
  let fb = '';
  if (state.answered) {
    const val = (state._lastWriteVal || '').toLowerCase().trim();
    const isCorrect = val === ex.blank.toLowerCase();
    fb = `<div class="feedback ${isCorrect ? 'correct' : 'wrong'}">
      <span class="fb-icon">${isCorrect ? 'âœ…' : 'âŒ'}</span>
      <div class="fb-text"><strong>${isCorrect ? 'Richtig!' : 'Falsch!'}</strong>${!isCorrect ? 'Richtige Antwort: <strong>' + ex.blank + '</strong>' : ''}</div>
    </div>`;
  }
  const parts = ex.sentence.split('___');
  const filled = state.answered ? (state._lastWriteVal || '') : '___';
  return `
    <div class="exercise-type" style="color:var(--teal);">ğŸ“ FÃ¼lle die LÃ¼cke</div>
    <div class="fill-sentence">${parts[0]}<span class="fill-blank">${state.answered ? state._lastWriteVal : '?'}</span>${parts[1] || ''}</div>
    ${ex.hint ? `<p class="exercise-hint">ğŸ’¡ ${ex.hint}</p>` : ''}
    <div class="text-input-wrap">
      <input class="text-input ${state.answered ? (state._lastWriteCorrect ? 'correct' : 'wrong') : ''}"
             id="fill-input" placeholder="Fehlendes Wort..."
             ${state.answered ? 'disabled' : ''}
             onkeydown="if(event.key==='Enter')checkFill()"
             value="${state.answered ? (state._lastWriteVal || '') : ''}">
    </div>
    ${fb}
    ${state.answered ? `<button class="check-btn next" onclick="nextExercise()">Weiter â†’</button>` :
      `<button class="check-btn primary" onclick="checkFill()">PrÃ¼fen</button>`}
  `;
}

function renderMatchExercise(ex) {
  if (!state.matchState) {
    const left = ex.pairs.map((p, i) => ({ text: p[0], idx: i, side: 'left' }));
    const right = ex.pairs.map((p, i) => ({ text: p[1], idx: i, side: 'right' }));
    // Shuffle right side
    for (let i = right.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [right[i], right[j]] = [right[j], right[i]];
    }
    state.matchState = { left, right, matched: [], selected: null, wrongFlash: null };
  }
  const ms = state.matchState;
  const allMatched = ms.matched.length === ex.pairs.length;

  return `
    <div class="exercise-type" style="color:var(--purple);">ğŸ”— Verbinde die Paare</div>
    <h3 class="exercise-prompt">${ex.prompt}</h3>
    <div class="match-grid">
      <div>
        ${ms.left.map(item => {
          const isMatched = ms.matched.includes(item.idx);
          const isSel = ms.selected && ms.selected.side === 'left' && ms.selected.idx === item.idx;
          const isWrong = ms.wrongFlash && ms.wrongFlash.side === 'left' && ms.wrongFlash.idx === item.idx;
          return `<div class="match-btn ${isMatched ? 'matched' : ''} ${isSel ? 'sel' : ''} ${isWrong ? 'wrong-flash' : ''}"
                       style="margin-bottom:8px;"
                       onclick="matchClick('left',${item.idx})">${item.text}</div>`;
        }).join('')}
      </div>
      <div>
        ${ms.right.map(item => {
          const isMatched = ms.matched.includes(item.idx);
          const isSel = ms.selected && ms.selected.side === 'right' && ms.selected.idx === item.idx;
          const isWrong = ms.wrongFlash && ms.wrongFlash.side === 'right' && ms.wrongFlash.idx === item.idx;
          return `<div class="match-btn ${isMatched ? 'matched' : ''} ${isSel ? 'sel' : ''} ${isWrong ? 'wrong-flash' : ''}"
                       style="margin-bottom:8px;"
                       onclick="matchClick('right',${item.idx})">${item.text}</div>`;
        }).join('')}
      </div>
    </div>
    ${allMatched ? `
      <div class="feedback correct"><span class="fb-icon">âœ…</span><div class="fb-text"><strong>Alle richtig!</strong></div></div>
      <button class="check-btn next" onclick="nextExercise()">Weiter â†’</button>
    ` : ''}
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXERCISE LOGIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pickOption(idx) {
  if (state.answered) return;
  state.selected = idx;
  render();
}
function checkPick() {
  const lesson = getLesson();
  const ex = lesson.exercises[state.exerciseIdx];
  state.answered = true;
  if (state.selected === ex.correct) {
    state.lessonXP += 2;
  } else {
    state.hearts = Math.max(0, state.hearts - 1);
  }
  render();
}
function checkWrite() {
  const input = document.getElementById('write-input');
  if (!input || !input.value.trim()) return;
  const lesson = getLesson();
  const ex = lesson.exercises[state.exerciseIdx];
  const val = input.value.trim();
  const isCorrect = val.toLowerCase() === ex.answer.toLowerCase();
  state._lastWriteVal = val;
  state._lastWriteCorrect = isCorrect;
  state.answered = true;
  if (isCorrect) state.lessonXP += 3;
  else state.hearts = Math.max(0, state.hearts - 1);
  render();
}
function checkFill() {
  const input = document.getElementById('fill-input');
  if (!input || !input.value.trim()) return;
  const lesson = getLesson();
  const ex = lesson.exercises[state.exerciseIdx];
  const val = input.value.trim();
  const isCorrect = val.toLowerCase() === ex.blank.toLowerCase();
  state._lastWriteVal = val;
  state._lastWriteCorrect = isCorrect;
  state.answered = true;
  if (isCorrect) state.lessonXP += 3;
  else state.hearts = Math.max(0, state.hearts - 1);
  render();
}
function matchClick(side, idx) {
  const ms = state.matchState;
  if (!ms || ms.matched.includes(idx) && side === 'left') return;
  if (ms.matched.includes(idx) && side === 'right') return;

  if (!ms.selected) {
    ms.selected = { side, idx };
    render();
  } else if (ms.selected.side === side) {
    ms.selected = { side, idx };
    render();
  } else {
    // Check match
    const leftIdx = side === 'left' ? idx : ms.selected.idx;
    const rightIdx = side === 'right' ? idx : ms.selected.idx;
    if (leftIdx === rightIdx) {
      ms.matched.push(leftIdx);
      ms.selected = null;
      state.lessonXP += 1;
      render();
    } else {
      ms.wrongFlash = { side, idx };
      state.hearts = Math.max(0, state.hearts - 1);
      render();
      setTimeout(() => { ms.wrongFlash = null; ms.selected = null; render(); }, 600);
    }
  }
}
function nextExercise() {
  state.exerciseIdx++;
  state.selected = null;
  state.answered = false;
  state.matchState = null;
  state._lastWriteVal = null;
  state._lastWriteCorrect = null;
  render();
}
function exitLesson() {
  state.screen = 'unit';
  state.matchState = null;
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-unit').classList.add('active');
  render();
}

function showComplete() {
  const lesson = getLesson();
  state.completedLessons[lesson.id] = true;
  state.xp += state.lessonXP + lesson.xp;
  const c = document.getElementById('screen-exercise');
  c.innerHTML = `
    <div class="complete-screen">
      <div class="complete-emoji">ğŸ‰</div>
      <h2>Lektion geschafft!</h2>
      <p class="sub">${lesson.title}</p>
      <div class="complete-stats">
        <div class="complete-stat"><div class="val" style="color:var(--amber);">+${state.lessonXP + lesson.xp}</div><div class="lbl">XP verdient</div></div>
        <div class="complete-stat"><div class="val" style="color:var(--red);">${state.hearts}/3</div><div class="lbl">Herzen Ã¼brig</div></div>
        <div class="complete-stat"><div class="val" style="color:var(--green);">âœ“</div><div class="lbl">Abgeschlossen</div></div>
      </div>
      <button class="check-btn primary" onclick="goScreen('unit');render();" style="max-width:300px;margin:0 auto;">Weiter lernen â†’</button>
    </div>
  `;
  updateStats();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// VOCAB
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderVocab() {
  const c = document.getElementById('screen-vocab');
  c.innerHTML = `
    <div style="margin:20px 0 20px;">
      <h2 class="sec-title">ğŸ”¤ Vokabeln</h2>
      <p class="sec-sub">Klick zum Aufdecken. Lerne Schritt fÃ¼r Schritt.</p>
    </div>
    ${Object.entries(VOCAB_DATA).map(([cat, words]) => `
      <div class="vocab-cat-title">${cat}</div>
      <div class="vocab-grid" style="margin-bottom:12px;">
        ${words.map((w, i) => {
          const key = cat + i;
          const flipped = state.flippedVocab[key];
          return `<div class="vocab-card ${flipped ? 'flipped' : ''}" onclick="flipVocab('${key}')">
            <div class="vocab-word">${w.pt}</div>
            <div class="vocab-trans">${flipped ? w.de : 'â€¢ â€¢ â€¢'}</div>
          </div>`;
        }).join('')}
      </div>
    `).join('')}
  `;
}
function flipVocab(key) {
  state.flippedVocab[key] = !state.flippedVocab[key];
  renderVocab();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GRAMMAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderGrammar() {
  const c = document.getElementById('screen-grammar');
  c.innerHTML = `
    <div style="margin:20px 0 20px;">
      <h2 class="sec-title">ğŸ“ Grammatik</h2>
      <p class="sec-sub">Die wichtigsten Regeln â€“ einfach erklÃ¤rt.</p>
    </div>
    ${GRAMMAR_DATA.map(g => `
      <div class="grammar-card">
        <h3>${g.title}</h3>
        <p>${g.content}</p>
        ${g.table ? `<table class="grammar-table">
          ${g.table.map((row, ri) => `<tr>${row.map((cell, ci) => ri === 0 ? `<th>${cell}</th>` : `<td>${cell}</td>`).join('')}</tr>`).join('')}
        </table>` : ''}
        ${g.examples.map(e => `
          <div class="grammar-example">
            <span class="pt">${e.pt}</span><br><span class="de">â†’ ${e.de}</span>
          </div>
        `).join('')}
      </div>
    `).join('')}
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SLANG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderSlangScreen() {
  const c = document.getElementById('screen-slang');
  c.innerHTML = `
    <div style="margin:20px 0 20px;">
      <h2 class="sec-title">ğŸ—£ï¸ GÃ­rias Brasileiras</h2>
      <p class="sec-sub">20 Slang-AusdrÃ¼cke, die kein Lehrbuch hat.</p>
    </div>
    ${SLANG_DATA.map((s, i) => `
      <div class="slang-item ${state.openSlang === i ? 'open' : ''}" onclick="toggleSlangItem(${i})">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div>
            <div class="slang-phrase2">â€${s.phrase}"</div>
            <div class="slang-mean">â†’ ${s.meaning}</div>
          </div>
          <span style="color:var(--purple);font-size:12px;transition:transform 0.3s;${state.openSlang === i ? 'transform:rotate(180deg)' : ''}">â–¾</span>
        </div>
        ${state.openSlang === i ? `
          <div class="slang-detail">
            <div class="tone-label">Ton / Stimmung</div>
            <p>${s.tone}</p>
            <div class="ex"><strong>Beispiel:</strong> ${s.example}</div>
          </div>
        ` : ''}
      </div>
    `).join('')}
  `;
}
function toggleSlangItem(i) {
  state.openSlang = state.openSlang === i ? -1 : i;
  renderSlangScreen();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
render();
</script>
</body>
</html>
